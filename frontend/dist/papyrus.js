!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.papyrus=t():e.papyrus=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";n.r(t),n.d(t,"Application",(function(){return X})),n.d(t,"Context",(function(){return O})),n.d(t,"Controller",(function(){return ie})),n.d(t,"defaultSchema",(function(){return V}));var r=function(){function e(e,t,n){this.eventTarget=e,this.eventName=t,this.eventOptions=n,this.unorderedBindings=new Set}return e.prototype.connect=function(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)},e.prototype.disconnect=function(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)},e.prototype.bindingConnected=function(e){this.unorderedBindings.add(e)},e.prototype.bindingDisconnected=function(e){this.unorderedBindings.delete(e)},e.prototype.handleEvent=function(e){for(var t=function(e){if("immediatePropagationStopped"in e)return e;var t=e.stopImmediatePropagation;return Object.assign(e,{immediatePropagationStopped:!1,stopImmediatePropagation:function(){this.immediatePropagationStopped=!0,t.call(this)}})}(e),n=0,r=this.bindings;n<r.length;n++){var i=r[n];if(t.immediatePropagationStopped)break;i.handleEvent(t)}},Object.defineProperty(e.prototype,"bindings",{get:function(){return Array.from(this.unorderedBindings).sort((function(e,t){var n=e.index,r=t.index;return n<r?-1:n>r?1:0}))},enumerable:!1,configurable:!0}),e}();var i=function(){function e(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}return e.prototype.start=function(){this.started||(this.started=!0,this.eventListeners.forEach((function(e){return e.connect()})))},e.prototype.stop=function(){this.started&&(this.started=!1,this.eventListeners.forEach((function(e){return e.disconnect()})))},Object.defineProperty(e.prototype,"eventListeners",{get:function(){return Array.from(this.eventListenerMaps.values()).reduce((function(e,t){return e.concat(Array.from(t.values()))}),[])},enumerable:!1,configurable:!0}),e.prototype.bindingConnected=function(e){this.fetchEventListenerForBinding(e).bindingConnected(e)},e.prototype.bindingDisconnected=function(e){this.fetchEventListenerForBinding(e).bindingDisconnected(e)},e.prototype.handleError=function(e,t,n){void 0===n&&(n={}),this.application.handleError(e,"Error "+t,n)},e.prototype.fetchEventListenerForBinding=function(e){var t=e.eventTarget,n=e.eventName,r=e.eventOptions;return this.fetchEventListener(t,n,r)},e.prototype.fetchEventListener=function(e,t,n){var r=this.fetchEventListenerMapForEventTarget(e),i=this.cacheKey(t,n),o=r.get(i);return o||(o=this.createEventListener(e,t,n),r.set(i,o)),o},e.prototype.createEventListener=function(e,t,n){var i=new r(e,t,n);return this.started&&i.connect(),i},e.prototype.fetchEventListenerMapForEventTarget=function(e){var t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t},e.prototype.cacheKey=function(e,t){var n=[e];return Object.keys(t).sort().forEach((function(e){n.push((t[e]?"":"!")+e)})),n.join(":")},e}(),o=/^((.+?)(@(window|document))?->)?(.+?)(#([^:]+?))(:(.+))?$/;var a=function(){function e(e,t,n){this.element=e,this.index=t,this.eventTarget=n.eventTarget||e,this.eventName=n.eventName||function(e){var t=e.tagName.toLowerCase();if(t in s)return s[t](e)}(e)||c("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||c("missing identifier"),this.methodName=n.methodName||c("missing method name")}return e.forToken=function(e){return new this(e.element,e.index,(n=e.content,i=n.trim().match(o)||[],{eventTarget:(t=i[4],"window"==t?window:"document"==t?document:void 0),eventName:i[2],eventOptions:i[9]?(r=i[9],r.split(":").reduce((function(e,t){var n;return Object.assign(e,((n={})[t.replace(/^!/,"")]=!/^!/.test(t),n))}),{})):{},identifier:i[5],methodName:i[7]}));var t,n,r,i},e.prototype.toString=function(){var e=this.eventTargetName?"@"+this.eventTargetName:"";return""+this.eventName+e+"->"+this.identifier+"#"+this.methodName},Object.defineProperty(e.prototype,"eventTargetName",{get:function(){return(e=this.eventTarget)==window?"window":e==document?"document":void 0;var e},enumerable:!1,configurable:!0}),e}(),s={a:function(e){return"click"},button:function(e){return"click"},form:function(e){return"submit"},input:function(e){return"submit"==e.getAttribute("type")?"click":"input"},select:function(e){return"change"},textarea:function(e){return"input"}};function c(e){throw new Error(e)}var u=function(){function e(e,t){this.context=e,this.action=t}return Object.defineProperty(e.prototype,"index",{get:function(){return this.action.index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventTarget",{get:function(){return this.action.eventTarget},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventOptions",{get:function(){return this.action.eventOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!1,configurable:!0}),e.prototype.handleEvent=function(e){this.willBeInvokedByEvent(e)&&this.invokeWithEvent(e)},Object.defineProperty(e.prototype,"eventName",{get:function(){return this.action.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){var e=this.controller[this.methodName];if("function"==typeof e)return e;throw new Error('Action "'+this.action+'" references undefined method "'+this.methodName+'"')},enumerable:!1,configurable:!0}),e.prototype.invokeWithEvent=function(e){try{this.method.call(this.controller,e)}catch(n){var t={identifier:this.identifier,controller:this.controller,element:this.element,index:this.index,event:e};this.context.handleError(n,'invoking action "'+this.action+'"',t)}},e.prototype.willBeInvokedByEvent=function(e){var t=e.target;return this.element===t||(t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element))},Object.defineProperty(e.prototype,"controller",{get:function(){return this.context.controller},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"methodName",{get:function(){return this.action.methodName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scope",{get:function(){return this.context.scope},enumerable:!1,configurable:!0}),e}(),l=function(){function e(e,t){var n=this;this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver((function(e){return n.processMutations(e)}))}return e.prototype.start=function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,childList:!0,subtree:!0}),this.refresh())},e.prototype.stop=function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)},e.prototype.refresh=function(){if(this.started){for(var e=new Set(this.matchElementsInTree()),t=0,n=Array.from(this.elements);t<n.length;t++){var r=n[t];e.has(r)||this.removeElement(r)}for(var i=0,o=Array.from(e);i<o.length;i++){r=o[i];this.addElement(r)}}},e.prototype.processMutations=function(e){if(this.started)for(var t=0,n=e;t<n.length;t++){var r=n[t];this.processMutation(r)}},e.prototype.processMutation=function(e){"attributes"==e.type?this.processAttributeChange(e.target,e.attributeName):"childList"==e.type&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))},e.prototype.processAttributeChange=function(e,t){var n=e;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,t):this.removeElement(n):this.matchElement(n)&&this.addElement(n)},e.prototype.processRemovedNodes=function(e){for(var t=0,n=Array.from(e);t<n.length;t++){var r=n[t],i=this.elementFromNode(r);i&&this.processTree(i,this.removeElement)}},e.prototype.processAddedNodes=function(e){for(var t=0,n=Array.from(e);t<n.length;t++){var r=n[t],i=this.elementFromNode(r);i&&this.elementIsActive(i)&&this.processTree(i,this.addElement)}},e.prototype.matchElement=function(e){return this.delegate.matchElement(e)},e.prototype.matchElementsInTree=function(e){return void 0===e&&(e=this.element),this.delegate.matchElementsInTree(e)},e.prototype.processTree=function(e,t){for(var n=0,r=this.matchElementsInTree(e);n<r.length;n++){var i=r[n];t.call(this,i)}},e.prototype.elementFromNode=function(e){if(e.nodeType==Node.ELEMENT_NODE)return e},e.prototype.elementIsActive=function(e){return e.isConnected==this.element.isConnected&&this.element.contains(e)},e.prototype.addElement=function(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))},e.prototype.removeElement=function(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))},e}(),p=function(){function e(e,t,n){this.attributeName=t,this.delegate=n,this.elementObserver=new l(e,this)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.elementObserver.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selector",{get:function(){return"["+this.attributeName+"]"},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.elementObserver.start()},e.prototype.stop=function(){this.elementObserver.stop()},e.prototype.refresh=function(){this.elementObserver.refresh()},Object.defineProperty(e.prototype,"started",{get:function(){return this.elementObserver.started},enumerable:!1,configurable:!0}),e.prototype.matchElement=function(e){return e.hasAttribute(this.attributeName)},e.prototype.matchElementsInTree=function(e){var t=this.matchElement(e)?[e]:[],n=Array.from(e.querySelectorAll(this.selector));return t.concat(n)},e.prototype.elementMatched=function(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)},e.prototype.elementUnmatched=function(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)},e.prototype.elementAttributeChanged=function(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)},e}(),f=function(){function e(e,t){var n=this;this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver((function(e){return n.processMutations(e)}))}return e.prototype.start=function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0}),this.refresh())},e.prototype.stop=function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)},e.prototype.refresh=function(){if(this.started)for(var e=0,t=this.knownAttributeNames;e<t.length;e++){var n=t[e];this.refreshAttribute(n)}},e.prototype.processMutations=function(e){if(this.started)for(var t=0,n=e;t<n.length;t++){var r=n[t];this.processMutation(r)}},e.prototype.processMutation=function(e){var t=e.attributeName;t&&this.refreshAttribute(t)},e.prototype.refreshAttribute=function(e){var t=this.delegate.getStringMapKeyForAttribute(e);if(null!=t){this.stringMap.has(e)||this.stringMapKeyAdded(t,e);var n=this.element.getAttribute(e);this.stringMap.get(e)!=n&&this.stringMapValueChanged(n,t),null==n?(this.stringMap.delete(e),this.stringMapKeyRemoved(t,e)):this.stringMap.set(e,n)}},e.prototype.stringMapKeyAdded=function(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)},e.prototype.stringMapValueChanged=function(e,t){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t)},e.prototype.stringMapKeyRemoved=function(e,t){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t)},Object.defineProperty(e.prototype,"knownAttributeNames",{get:function(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentAttributeNames",{get:function(){return Array.from(this.element.attributes).map((function(e){return e.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"recordedAttributeNames",{get:function(){return Array.from(this.stringMap.keys())},enumerable:!1,configurable:!0}),e}();function h(e,t,n){_(e,t).add(n)}function d(e,t,n){_(e,t).delete(n),function(e,t){var n=e.get(t);null!=n&&0==n.size&&e.delete(t)}(e,t)}function _(e,t){var n=e.get(t);return n||(n=new Set,e.set(t,n)),n}var y,m=function(){function e(){this.valuesByKey=new Map}return Object.defineProperty(e.prototype,"values",{get:function(){return Array.from(this.valuesByKey.values()).reduce((function(e,t){return e.concat(Array.from(t))}),[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return Array.from(this.valuesByKey.values()).reduce((function(e,t){return e+t.size}),0)},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t){h(this.valuesByKey,e,t)},e.prototype.delete=function(e,t){d(this.valuesByKey,e,t)},e.prototype.has=function(e,t){var n=this.valuesByKey.get(e);return null!=n&&n.has(t)},e.prototype.hasKey=function(e){return this.valuesByKey.has(e)},e.prototype.hasValue=function(e){return Array.from(this.valuesByKey.values()).some((function(t){return t.has(e)}))},e.prototype.getValuesForKey=function(e){var t=this.valuesByKey.get(e);return t?Array.from(t):[]},e.prototype.getKeysForValue=function(e){return Array.from(this.valuesByKey).filter((function(t){t[0];return t[1].has(e)})).map((function(e){var t=e[0];e[1];return t}))},e}(),g=(y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),b=(function(e){function t(){var t=e.call(this)||this;return t.keysByValue=new Map,t}g(t,e),Object.defineProperty(t.prototype,"values",{get:function(){return Array.from(this.keysByValue.keys())},enumerable:!1,configurable:!0}),t.prototype.add=function(t,n){e.prototype.add.call(this,t,n),h(this.keysByValue,n,t)},t.prototype.delete=function(t,n){e.prototype.delete.call(this,t,n),d(this.keysByValue,n,t)},t.prototype.hasValue=function(e){return this.keysByValue.has(e)},t.prototype.getKeysForValue=function(e){var t=this.keysByValue.get(e);return t?Array.from(t):[]}}(m),function(){function e(e,t,n){this.attributeObserver=new p(e,t,this),this.delegate=n,this.tokensByElement=new m}return Object.defineProperty(e.prototype,"started",{get:function(){return this.attributeObserver.started},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.attributeObserver.start()},e.prototype.stop=function(){this.attributeObserver.stop()},e.prototype.refresh=function(){this.attributeObserver.refresh()},Object.defineProperty(e.prototype,"element",{get:function(){return this.attributeObserver.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this.attributeObserver.attributeName},enumerable:!1,configurable:!0}),e.prototype.elementMatchedAttribute=function(e){this.tokensMatched(this.readTokensForElement(e))},e.prototype.elementAttributeValueChanged=function(e){var t=this.refreshTokensForElement(e),n=t[0],r=t[1];this.tokensUnmatched(n),this.tokensMatched(r)},e.prototype.elementUnmatchedAttribute=function(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))},e.prototype.tokensMatched=function(e){var t=this;e.forEach((function(e){return t.tokenMatched(e)}))},e.prototype.tokensUnmatched=function(e){var t=this;e.forEach((function(e){return t.tokenUnmatched(e)}))},e.prototype.tokenMatched=function(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)},e.prototype.tokenUnmatched=function(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)},e.prototype.refreshTokensForElement=function(e){var t,n,r,i=this.tokensByElement.getValuesForKey(e),o=this.readTokensForElement(e),a=(t=i,n=o,r=Math.max(t.length,n.length),Array.from({length:r},(function(e,r){return[t[r],n[r]]}))).findIndex((function(e){return!function(e,t){return e&&t&&e.index==t.index&&e.content==t.content}(e[0],e[1])}));return-1==a?[[],[]]:[i.slice(a),o.slice(a)]},e.prototype.readTokensForElement=function(e){var t=this.attributeName;return function(e,t,n){return e.trim().split(/\s+/).filter((function(e){return e.length})).map((function(e,r){return{element:t,attributeName:n,content:e,index:r}}))}(e.getAttribute(t)||"",e,t)},e}());var v=function(){function e(e,t,n){this.tokenListObserver=new b(e,t,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}return Object.defineProperty(e.prototype,"started",{get:function(){return this.tokenListObserver.started},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.tokenListObserver.start()},e.prototype.stop=function(){this.tokenListObserver.stop()},e.prototype.refresh=function(){this.tokenListObserver.refresh()},Object.defineProperty(e.prototype,"element",{get:function(){return this.tokenListObserver.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this.tokenListObserver.attributeName},enumerable:!1,configurable:!0}),e.prototype.tokenMatched=function(e){var t=e.element,n=this.fetchParseResultForToken(e).value;n&&(this.fetchValuesByTokenForElement(t).set(e,n),this.delegate.elementMatchedValue(t,n))},e.prototype.tokenUnmatched=function(e){var t=e.element,n=this.fetchParseResultForToken(e).value;n&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,n))},e.prototype.fetchParseResultForToken=function(e){var t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t},e.prototype.fetchValuesByTokenForElement=function(e){var t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t},e.prototype.parseToken=function(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(e){return{error:e}}},e}(),w=function(){function e(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}return e.prototype.start=function(){this.valueListObserver||(this.valueListObserver=new v(this.element,this.actionAttribute,this),this.valueListObserver.start())},e.prototype.stop=function(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())},Object.defineProperty(e.prototype,"element",{get:function(){return this.context.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actionAttribute",{get:function(){return this.schema.actionAttribute},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.context.schema},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bindings",{get:function(){return Array.from(this.bindingsByAction.values())},enumerable:!1,configurable:!0}),e.prototype.connectAction=function(e){var t=new u(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)},e.prototype.disconnectAction=function(e){var t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))},e.prototype.disconnectAllActions=function(){var e=this;this.bindings.forEach((function(t){return e.delegate.bindingDisconnected(t)})),this.bindingsByAction.clear()},e.prototype.parseValueForToken=function(e){var t=a.forToken(e);if(t.identifier==this.identifier)return t},e.prototype.elementMatchedValue=function(e,t){this.connectAction(t)},e.prototype.elementUnmatchedValue=function(e,t){this.disconnectAction(t)},e}(),S=function(){function e(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new f(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap,this.invokeChangedCallbacksForDefaultValues()}return e.prototype.start=function(){this.stringMapObserver.start()},e.prototype.stop=function(){this.stringMapObserver.stop()},Object.defineProperty(e.prototype,"element",{get:function(){return this.context.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){return this.context.controller},enumerable:!1,configurable:!0}),e.prototype.getStringMapKeyForAttribute=function(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name},e.prototype.stringMapValueChanged=function(e,t){this.invokeChangedCallbackForValue(t)},e.prototype.invokeChangedCallbacksForDefaultValues=function(){for(var e=0,t=this.valueDescriptors;e<t.length;e++){var n=t[e],r=n.key,i=n.name;null==n.defaultValue||this.controller.data.has(r)||this.invokeChangedCallbackForValue(i)}},e.prototype.invokeChangedCallbackForValue=function(e){var t=e+"Changed",n=this.receiver[t];if("function"==typeof n){var r=this.receiver[e];n.call(this.receiver,r)}},Object.defineProperty(e.prototype,"valueDescriptors",{get:function(){var e=this.valueDescriptorMap;return Object.keys(e).map((function(t){return e[t]}))},enumerable:!1,configurable:!0}),e}(),O=function(){function e(e,t){this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new w(this,this.dispatcher),this.valueObserver=new S(this,this.controller);try{this.controller.initialize()}catch(e){this.handleError(e,"initializing controller")}}return e.prototype.connect=function(){this.bindingObserver.start(),this.valueObserver.start();try{this.controller.connect()}catch(e){this.handleError(e,"connecting controller")}},e.prototype.disconnect=function(){try{this.controller.disconnect()}catch(e){this.handleError(e,"disconnecting controller")}this.valueObserver.stop(),this.bindingObserver.stop()},Object.defineProperty(e.prototype,"application",{get:function(){return this.module.application},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.module.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.application.schema},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dispatcher",{get:function(){return this.application.dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.element.parentElement},enumerable:!1,configurable:!0}),e.prototype.handleError=function(e,t,n){void 0===n&&(n={});var r=this.identifier,i=this.controller,o=this.element;n=Object.assign({identifier:r,controller:i,element:o},n),this.application.handleError(e,"Error "+t,n)},e}();function C(e,t){var n=E(e);return Array.from(n.reduce((function(e,n){return function(e,t){var n=e[t];return Array.isArray(n)?n:[]}(n,t).forEach((function(t){return e.add(t)})),e}),new Set))}function I(e,t){return E(e).reduce((function(e,n){return e.push.apply(e,function(e,t){var n=e[t];return n?Object.keys(n).map((function(e){return[e,n[e]]})):[]}(n,t)),e}),[])}function E(e){for(var t=[];e;)t.push(e),e=Object.getPrototypeOf(e);return t.reverse()}var P=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};function M(e){return function(e,t){var n=k(e),r=function(e,t){return B(t).reduce((function(n,r){var i,o=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,n);if(!r||!("value"in r)){var i=Object.getOwnPropertyDescriptor(t,n).value;return r&&(i.get=r.get||i.get,i.set=r.set||i.set),i}}(e,t,r);return o&&Object.assign(n,((i={})[r]=o,i)),n}),{})}(e.prototype,t);return Object.defineProperties(n.prototype,r),n}(e,function(e){return C(e,"blessings").reduce((function(t,n){var r=n(e);for(var i in r){var o=t[i]||{};t[i]=Object.assign(o,r[i])}return t}),{})}(e))}var B="function"==typeof Object.getOwnPropertySymbols?function(e){return A(Object.getOwnPropertyNames(e),Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,k=function(){function e(e){function t(){var n=this&&this instanceof t?this.constructor:void 0;return Reflect.construct(e,arguments,n)}return t.prototype=Object.create(e.prototype,{constructor:{value:t}}),Reflect.setPrototypeOf(t,e),t}try{return(t=e((function(){this.a.call(this)}))).prototype.a=function(){},new t,e}catch(e){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(e)}}var t}();var T=function(){function e(e,t){this.application=e,this.definition=function(e){return{identifier:e.identifier,controllerConstructor:M(e.controllerConstructor)}}(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.definition.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerConstructor",{get:function(){return this.definition.controllerConstructor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contexts",{get:function(){return Array.from(this.connectedContexts)},enumerable:!1,configurable:!0}),e.prototype.connectContextForScope=function(e){var t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()},e.prototype.disconnectContextForScope=function(e){var t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())},e.prototype.fetchContextForScope=function(e){var t=this.contextsByScope.get(e);return t||(t=new O(this,e),this.contextsByScope.set(e,t)),t},e}(),D=function(){function e(e){this.scope=e}return e.prototype.has=function(e){return this.data.has(this.getDataKey(e))},e.prototype.get=function(e){return this.data.get(this.getDataKey(e))},e.prototype.getAttributeName=function(e){return this.data.getAttributeNameForKey(this.getDataKey(e))},e.prototype.getDataKey=function(e){return e+"-class"},Object.defineProperty(e.prototype,"data",{get:function(){return this.scope.data},enumerable:!1,configurable:!0}),e}();function j(e){return e.charAt(0).toUpperCase()+e.slice(1)}function x(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}))}var N=function(){function e(e){this.scope=e}return Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)},e.prototype.set=function(e,t){var n=this.getAttributeNameForKey(e);return this.element.setAttribute(n,t),this.get(e)},e.prototype.has=function(e){var t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)},e.prototype.delete=function(e){if(this.has(e)){var t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}return!1},e.prototype.getAttributeNameForKey=function(e){return"data-"+this.identifier+"-"+x(e)},e}(),U=function(){function e(e){this.warnedKeysByObject=new WeakMap,this.logger=e}return e.prototype.warn=function(e,t,n){var r=this.warnedKeysByObject.get(e);r||(r=new Set,this.warnedKeysByObject.set(e,r)),r.has(t)||(r.add(t),this.logger.warn(n,e))},e}();function F(e,t){return"["+e+'~="'+t+'"]'}var L=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},R=function(){function e(e){this.scope=e}return Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.scope.schema},enumerable:!1,configurable:!0}),e.prototype.has=function(e){return null!=this.find(e)},e.prototype.find=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce((function(t,n){return t||e.findTarget(n)||e.findLegacyTarget(n)}),void 0)},e.prototype.findAll=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce((function(t,n){return L(t,e.findAllTargets(n),e.findAllLegacyTargets(n))}),[])},e.prototype.findTarget=function(e){var t=this.getSelectorForTargetName(e);return this.scope.findElement(t)},e.prototype.findAllTargets=function(e){var t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)},e.prototype.getSelectorForTargetName=function(e){return F("data-"+this.identifier+"-target",e)},e.prototype.findLegacyTarget=function(e){var t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)},e.prototype.findAllLegacyTargets=function(e){var t=this,n=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(n).map((function(n){return t.deprecate(n,e)}))},e.prototype.getLegacySelectorForTargetName=function(e){var t=this.identifier+"."+e;return F(this.schema.targetAttribute,t)},e.prototype.deprecate=function(e,t){if(e){var n=this.identifier,r=this.schema.targetAttribute;this.guide.warn(e,"target:"+t,"Please replace "+r+'="'+n+"."+t+'" with data-'+n+'-target="'+t+'". The '+r+" attribute is deprecated and will be removed in a future version of Stimulus.")}return e},Object.defineProperty(e.prototype,"guide",{get:function(){return this.scope.guide},enumerable:!1,configurable:!0}),e}(),W=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},J=function(){function e(e,t,n,r){var i=this;this.targets=new R(this),this.classes=new D(this),this.data=new N(this),this.containsElement=function(e){return e.closest(i.controllerSelector)===i.element},this.schema=e,this.element=t,this.identifier=n,this.guide=new U(r)}return e.prototype.findElement=function(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)},e.prototype.findAllElements=function(e){return W(this.element.matches(e)?[this.element]:[],this.queryElements(e).filter(this.containsElement))},e.prototype.queryElements=function(e){return Array.from(this.element.querySelectorAll(e))},Object.defineProperty(e.prototype,"controllerSelector",{get:function(){return F(this.schema.controllerAttribute,this.identifier)},enumerable:!1,configurable:!0}),e}(),z=function(){function e(e,t,n){this.element=e,this.schema=t,this.delegate=n,this.valueListObserver=new v(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}return e.prototype.start=function(){this.valueListObserver.start()},e.prototype.stop=function(){this.valueListObserver.stop()},Object.defineProperty(e.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!1,configurable:!0}),e.prototype.parseValueForToken=function(e){var t=e.element,n=e.content,r=this.fetchScopesByIdentifierForElement(t),i=r.get(n);return i||(i=this.delegate.createScopeForElementAndIdentifier(t,n),r.set(n,i)),i},e.prototype.elementMatchedValue=function(e,t){var n=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,n),1==n&&this.delegate.scopeConnected(t)},e.prototype.elementUnmatchedValue=function(e,t){var n=this.scopeReferenceCounts.get(t);n&&(this.scopeReferenceCounts.set(t,n-1),1==n&&this.delegate.scopeDisconnected(t))},e.prototype.fetchScopesByIdentifierForElement=function(e){var t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t},e}(),K=function(){function e(e){this.application=e,this.scopeObserver=new z(this.element,this.schema,this),this.scopesByIdentifier=new m,this.modulesByIdentifier=new Map}return Object.defineProperty(e.prototype,"element",{get:function(){return this.application.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.application.schema},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logger",{get:function(){return this.application.logger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modules",{get:function(){return Array.from(this.modulesByIdentifier.values())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contexts",{get:function(){return this.modules.reduce((function(e,t){return e.concat(t.contexts)}),[])},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.scopeObserver.start()},e.prototype.stop=function(){this.scopeObserver.stop()},e.prototype.loadDefinition=function(e){this.unloadIdentifier(e.identifier);var t=new T(this.application,e);this.connectModule(t)},e.prototype.unloadIdentifier=function(e){var t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)},e.prototype.getContextForElementAndIdentifier=function(e,t){var n=this.modulesByIdentifier.get(t);if(n)return n.contexts.find((function(t){return t.element==e}))},e.prototype.handleError=function(e,t,n){this.application.handleError(e,t,n)},e.prototype.createScopeForElementAndIdentifier=function(e,t){return new J(this.schema,e,t,this.logger)},e.prototype.scopeConnected=function(e){this.scopesByIdentifier.add(e.identifier,e);var t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)},e.prototype.scopeDisconnected=function(e){this.scopesByIdentifier.delete(e.identifier,e);var t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)},e.prototype.connectModule=function(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((function(t){return e.connectContextForScope(t)}))},e.prototype.disconnectModule=function(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((function(t){return e.disconnectContextForScope(t)}))},e}(),V={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target"},G=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},H=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},q=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},X=function(){function e(e,t){void 0===e&&(e=document.documentElement),void 0===t&&(t=V),this.logger=console,this.element=e,this.schema=t,this.dispatcher=new i(this),this.router=new K(this)}return e.start=function(t,n){var r=new e(t,n);return r.start(),r},e.prototype.start=function(){return G(this,void 0,void 0,(function(){return H(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",e):e()}))];case 1:return e.sent(),this.dispatcher.start(),this.router.start(),[2]}}))}))},e.prototype.stop=function(){this.dispatcher.stop(),this.router.stop()},e.prototype.register=function(e,t){this.load({identifier:e,controllerConstructor:t})},e.prototype.load=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=Array.isArray(e)?e:q([e],n);i.forEach((function(e){return t.router.loadDefinition(e)}))},e.prototype.unload=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=Array.isArray(e)?e:q([e],n);i.forEach((function(e){return t.router.unloadIdentifier(e)}))},Object.defineProperty(e.prototype,"controllers",{get:function(){return this.router.contexts.map((function(e){return e.controller}))},enumerable:!1,configurable:!0}),e.prototype.getControllerForElementAndIdentifier=function(e,t){var n=this.router.getContextForElementAndIdentifier(e,t);return n?n.controller:null},e.prototype.handleError=function(e,t,n){this.logger.error("%s\n\n%o\n\n%o",t,e,n)},e}();function Y(e){return C(e,"classes").reduce((function(e,t){return Object.assign(e,((r={})[i=(n=t)+"Class"]={get:function(){var e=this.classes;if(e.has(n))return e.get(n);var t=e.getAttributeName(n);throw new Error('Missing attribute "'+t+'"')}},r["has"+j(i)]={get:function(){return this.classes.has(n)}},r));var n,r,i}),{})}function Z(e){return C(e,"targets").reduce((function(e,t){return Object.assign(e,((r={})[(n=t)+"Target"]={get:function(){var e=this.targets.find(n);if(e)return e;throw new Error('Missing target element "'+this.identifier+"."+n+'"')}},r[n+"Targets"]={get:function(){return this.targets.findAll(n)}},r["has"+j(n)+"Target"]={get:function(){return this.targets.has(n)}},r));var n,r}),{})}function $(e){var t=I(e,"values"),n={valueDescriptorMap:{get:function(){var e=this;return t.reduce((function(t,n){var r,i=Q(n),o=e.data.getAttributeNameForKey(i.key);return Object.assign(t,((r={})[o]=i,r))}),{})}}};return t.reduce((function(e,t){return Object.assign(e,function(e){var t,n=Q(e),r=n.type,i=n.key,o=n.name,a=te[r],s=ne[r]||ne.default;return(t={})[o]={get:function(){var e=this.data.get(i);return null!==e?a(e):n.defaultValue},set:function(e){void 0===e?this.data.delete(i):this.data.set(i,s(e))}},t["has"+j(o)]={get:function(){return this.data.has(i)}},t}(t))}),n)}function Q(e){return function(e,t){var n=x(e)+"-value";return{type:t,key:n,name:(r=n,r.replace(/(?:[_-])([a-z0-9])/g,(function(e,t){return t.toUpperCase()}))),get defaultValue(){return ee[t]}};var r}(e[0],function(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}throw new Error('Unknown value type constant "'+e+'"')}(e[1]))}var ee={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},te={array:function(e){var t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError("Expected array");return t},boolean:function(e){return!("0"==e||"false"==e)},number:function(e){return parseFloat(e)},object:function(e){var t=JSON.parse(e);if(null===t||"object"!=typeof t||Array.isArray(t))throw new TypeError("Expected object");return t},string:function(e){return e}},ne={default:function(e){return""+e},array:re,object:re};function re(e){return JSON.stringify(e)}var ie=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"application",{get:function(){return this.context.application},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scope",{get:function(){return this.context.scope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targets",{get:function(){return this.scope.targets},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classes",{get:function(){return this.scope.classes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.scope.data},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){},e.prototype.connect=function(){},e.prototype.disconnect=function(){},e.blessings=[Y,Z,$],e.targets=[],e.values={},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Papyrus=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(2);var i=n(13),o=n(0);n(3);t.Papyrus=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"start",value:function(e){e||(e=o.Application.start()),console.log("Papyrus"),this.application=e;var t=n(10);this.application.load((0,i.definitionsFromContext)(t))}}]),e}()},function(e,t,n){},function(e,t,n){"use strict";var r=n(4);r.keys().forEach(r)},function(e,t,n){var r={"./print_channel.js":5};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=4},function(e,t,n){"use strict";var r=o(n(6)),i=o(n(8));o(n(9));function o(e){return e&&e.__esModule?e:{default:e}}r.default.subscriptions.create({channel:"Papyrus::PrintChannel"},{connected:function(){var e=this;i.default.JSPrintManager.auto_reconnect=!0,i.default.JSPrintManager.start(),i.default.JSPrintManager.WS.onStatusChanged=function(){i.default.JSPrintManager.websocket_status==i.default.WSStatus.Open?(console.log("Print client application is running"),i.default.JSPrintManager.getPrintersInfo().then((function(t){e.printersList(t)}))):i.default.JSPrintManager.websocket_status==i.default.WSStatus.Closed?console.log("Print client application is not installed or not running!"):i.default.JSPrintManager.websocket_status==i.default.WSStatus.Blocked&&console.log("Print client application has blocked this website!")}},disconnected:function(){},printersList:function(e){this.perform("printers_list",{printersList:e})},received:function(e){console.log(e);if(i.default.JSPrintManager.websocket_status==i.default.WSStatus.Open){var t=new i.default.ClientPrintJob;t.clientPrinter=new i.default.InstalledPrinter(e.printer),"raw"==e.kind?t.printerCommands="RAW PRINTER COMMANDS HERE":t.files.push(new(i.default["PrintFile"+e.kind.toUpperCase()])(e.url,i.default.FileSourceType.URL,e.filename,e.copies)),t.onUpdated=function(e){console.info(e)},t.onFinished=function(e){console.info(e)},t.sendToClient()}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.default=(0,r.createConsumer)()},function(e,t,n){!function(e){"use strict";var t={logger:self.console,WebSocket:self.WebSocket},n={log:function(){if(this.enabled){for(var e,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.push(Date.now()),(e=t.logger).log.apply(e,["[ActionCable]"].concat(r))}}},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){return(new Date).getTime()},s=function(e){return(a()-e)/1e3},c=function(){function e(t){i(this,e),this.visibilityDidChange=this.visibilityDidChange.bind(this),this.connection=t,this.reconnectAttempts=0}return e.prototype.start=function(){this.isRunning()||(this.startedAt=a(),delete this.stoppedAt,this.startPolling(),addEventListener("visibilitychange",this.visibilityDidChange),n.log("ConnectionMonitor started. pollInterval = "+this.getPollInterval()+" ms"))},e.prototype.stop=function(){this.isRunning()&&(this.stoppedAt=a(),this.stopPolling(),removeEventListener("visibilitychange",this.visibilityDidChange),n.log("ConnectionMonitor stopped"))},e.prototype.isRunning=function(){return this.startedAt&&!this.stoppedAt},e.prototype.recordPing=function(){this.pingedAt=a()},e.prototype.recordConnect=function(){this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,n.log("ConnectionMonitor recorded connect")},e.prototype.recordDisconnect=function(){this.disconnectedAt=a(),n.log("ConnectionMonitor recorded disconnect")},e.prototype.startPolling=function(){this.stopPolling(),this.poll()},e.prototype.stopPolling=function(){clearTimeout(this.pollTimeout)},e.prototype.poll=function(){var e=this;this.pollTimeout=setTimeout((function(){e.reconnectIfStale(),e.poll()}),this.getPollInterval())},e.prototype.getPollInterval=function(){var e=this.constructor.pollInterval,t=e.min,n=e.max,r=e.multiplier*Math.log(this.reconnectAttempts+1);return Math.round(1e3*function(e,t,n){return Math.max(t,Math.min(n,e))}(r,t,n))},e.prototype.reconnectIfStale=function(){this.connectionIsStale()&&(n.log("ConnectionMonitor detected stale connection. reconnectAttempts = "+this.reconnectAttempts+", pollInterval = "+this.getPollInterval()+" ms, time disconnected = "+s(this.disconnectedAt)+" s, stale threshold = "+this.constructor.staleThreshold+" s"),this.reconnectAttempts++,this.disconnectedRecently()?n.log("ConnectionMonitor skipping reopening recent disconnect"):(n.log("ConnectionMonitor reopening"),this.connection.reopen()))},e.prototype.connectionIsStale=function(){return s(this.pingedAt?this.pingedAt:this.startedAt)>this.constructor.staleThreshold},e.prototype.disconnectedRecently=function(){return this.disconnectedAt&&s(this.disconnectedAt)<this.constructor.staleThreshold},e.prototype.visibilityDidChange=function(){var e=this;"visible"===document.visibilityState&&setTimeout((function(){!e.connectionIsStale()&&e.connection.isOpen()||(n.log("ConnectionMonitor reopening stale connection on visibilitychange. visibilityState = "+document.visibilityState),e.connection.reopen())}),200)},e}();c.pollInterval={min:3,max:30,multiplier:5},c.staleThreshold=6;var u={message_types:{welcome:"welcome",disconnect:"disconnect",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},disconnect_reasons:{unauthorized:"unauthorized",invalid_request:"invalid_request",server_restart:"server_restart"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]},l=u.message_types,p=u.protocols,f=p.slice(0,p.length-1),h=[].indexOf,d=function(){function e(t){i(this,e),this.open=this.open.bind(this),this.consumer=t,this.subscriptions=this.consumer.subscriptions,this.monitor=new c(this),this.disconnected=!0}return e.prototype.send=function(e){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(e)),!0)},e.prototype.open=function(){return this.isActive()?(n.log("Attempted to open WebSocket, but existing socket is "+this.getState()),!1):(n.log("Opening WebSocket, current state is "+this.getState()+", subprotocols: "+p),this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new t.WebSocket(this.consumer.url,p),this.installEventHandlers(),this.monitor.start(),!0)},e.prototype.close=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allowReconnect:!0},t=e.allowReconnect;if(t||this.monitor.stop(),this.isActive())return this.webSocket.close()},e.prototype.reopen=function(){if(n.log("Reopening WebSocket, current state is "+this.getState()),!this.isActive())return this.open();try{return this.close()}catch(e){n.log("Failed to reopen WebSocket",e)}finally{n.log("Reopening WebSocket in "+this.constructor.reopenDelay+"ms"),setTimeout(this.open,this.constructor.reopenDelay)}},e.prototype.getProtocol=function(){if(this.webSocket)return this.webSocket.protocol},e.prototype.isOpen=function(){return this.isState("open")},e.prototype.isActive=function(){return this.isState("open","connecting")},e.prototype.isProtocolSupported=function(){return h.call(f,this.getProtocol())>=0},e.prototype.isState=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.call(t,this.getState())>=0},e.prototype.getState=function(){if(this.webSocket)for(var e in t.WebSocket)if(t.WebSocket[e]===this.webSocket.readyState)return e.toLowerCase();return null},e.prototype.installEventHandlers=function(){for(var e in this.events){var t=this.events[e].bind(this);this.webSocket["on"+e]=t}},e.prototype.uninstallEventHandlers=function(){for(var e in this.events)this.webSocket["on"+e]=function(){}},e}();d.reopenDelay=500,d.prototype.events={message:function(e){if(this.isProtocolSupported()){var t=JSON.parse(e.data),r=t.identifier,i=t.message,o=t.reason,a=t.reconnect;switch(t.type){case l.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case l.disconnect:return n.log("Disconnecting. Reason: "+o),this.close({allowReconnect:a});case l.ping:return this.monitor.recordPing();case l.confirmation:return this.subscriptions.notify(r,"connected");case l.rejection:return this.subscriptions.reject(r);default:return this.subscriptions.notify(r,"received",i)}}},open:function(){if(n.log("WebSocket onopen event, using '"+this.getProtocol()+"' subprotocol"),this.disconnected=!1,!this.isProtocolSupported())return n.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close:function(e){if(n.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error:function(){n.log("WebSocket onerror event")}};var _=function(e,t){if(null!=t)for(var n in t){var r=t[n];e[n]=r}return e},y=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];i(this,e),this.consumer=t,this.identifier=JSON.stringify(n),_(this,r)}return e.prototype.perform=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.action=e,this.send(t)},e.prototype.send=function(e){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(e)})},e.prototype.unsubscribe=function(){return this.consumer.subscriptions.remove(this)},e}(),m=function(){function e(t){i(this,e),this.consumer=t,this.subscriptions=[]}return e.prototype.create=function(e,t){var n=e,i="object"===(void 0===n?"undefined":r(n))?n:{channel:n},o=new y(this.consumer,i,t);return this.add(o)},e.prototype.add=function(e){return this.subscriptions.push(e),this.consumer.ensureActiveConnection(),this.notify(e,"initialized"),this.sendCommand(e,"subscribe"),e},e.prototype.remove=function(e){return this.forget(e),this.findAll(e.identifier).length||this.sendCommand(e,"unsubscribe"),e},e.prototype.reject=function(e){var t=this;return this.findAll(e).map((function(e){return t.forget(e),t.notify(e,"rejected"),e}))},e.prototype.forget=function(e){return this.subscriptions=this.subscriptions.filter((function(t){return t!==e})),e},e.prototype.findAll=function(e){return this.subscriptions.filter((function(t){return t.identifier===e}))},e.prototype.reload=function(){var e=this;return this.subscriptions.map((function(t){return e.sendCommand(t,"subscribe")}))},e.prototype.notifyAll=function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.subscriptions.map((function(n){return t.notify.apply(t,[n,e].concat(r))}))},e.prototype.notify=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return("string"==typeof e?this.findAll(e):[e]).map((function(e){return"function"==typeof e[t]?e[t].apply(e,r):void 0}))},e.prototype.sendCommand=function(e,t){var n=e.identifier;return this.consumer.send({command:t,identifier:n})},e}(),g=function(){function e(t){i(this,e),this._url=t,this.subscriptions=new m(this),this.connection=new d(this)}return e.prototype.send=function(e){return this.connection.send(e)},e.prototype.connect=function(){return this.connection.open()},e.prototype.disconnect=function(){return this.connection.close({allowReconnect:!1})},e.prototype.ensureActiveConnection=function(){if(!this.connection.isActive())return this.connection.open()},o(e,[{key:"url",get:function(){return b(this._url)}}]),e}();function b(e){if("function"==typeof e&&(e=e()),e&&!/^wss?:/i.test(e)){var t=document.createElement("a");return t.href=e,t.href=t.href,t.protocol=t.protocol.replace("http","ws"),t.href}return e}function v(e){var t=document.head.querySelector("meta[name='action-cable-"+e+"']");if(t)return t.getAttribute("content")}e.Connection=d,e.ConnectionMonitor=c,e.Consumer=g,e.INTERNAL=u,e.Subscription=y,e.Subscriptions=m,e.adapters=t,e.createWebSocketURL=b,e.logger=n,e.createConsumer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v("url")||u.default_mount_path;return new g(e)},e.getConfig=v,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){var r,i;
/*!
 * JSPrintManager v3.0.6
 * https://neodynamic.com/products/printing/js-print-manager
 *
 * GitHub Repo 
 * https://github.com/neodynamic/jsprintmanager
 *
 * Requires zip.js, zip-ext.js, and defalte.js files from 
 * https://github.com/gildas-lormeau/zip.js
 * 
 * Requires JSPrintManager Client App
 * https://neodynamic.com/downloads/jspm
 *
 * Copyright Neodynamic SRL
 * https://neodynamic.com
 * Date: 2020-11-11
 */!function(e){var t=function(){function t(){this._type=""}return t.prototype._generateDataAsync=function(){return new Promise((function(e){}))},t.prototype.onUpdate=function(e,t){},t.prototype.onError=function(e,t){},t.prototype.sendToClient=function(){var t=this;return new Promise((function(n,r){t._generateDataAsync().then((function(i){var o={type:t._type,on_update:function(e,r,i){r?n(e):t.onUpdate(e,i)},on_error:function(e,n,i){n?r(e):t.onError(e,i)}};e.JSPrintManager.WS.send(i,o)})).catch((function(e){return r(e)}))}))},t}();e.ClientJob=t}(s||(s={}));var o,a=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){var t=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n._clientPrinter=null,n._printerCommandsCopies=1,n._printerCommands="",n._printerCommandsCodePage=e.Encoding.Default,n._binaryPrinterCommands=null,n._printFileGroup=[],n}return a(n,t),Object.defineProperty(n.prototype,"clientPrinter",{get:function(){return this._clientPrinter},set:function(e){this._clientPrinter=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"printerCommandsCopies",{get:function(){return this._printerCommandsCopies},set:function(e){if(e<1)throw"Copies must be greater than or equal to 1.";this._printerCommandsCopies=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"printerCommands",{get:function(){return this._printerCommands},set:function(e){this._printerCommands=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"printerCommandsCodePage",{get:function(){return this._printerCommandsCodePage},set:function(e){this._printerCommandsCodePage=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"binaryPrinterCommands",{get:function(){return this._binaryPrinterCommands},set:function(e){this._binaryPrinterCommands=e,this._printerCommands=""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"files",{get:function(){return this._printFileGroup},enumerable:!0,configurable:!0}),n.prototype.onUpdated=function(e){},n.prototype.onFinished=function(e){},n.prototype.onError=function(e,t){},n.prototype.onUpdate=function(e,t){t?this.onFinished(e):this.onUpdated(e)},n.prototype._genPFGArrayAsync=function(e){return new Promise((function(t,n){zip?(zip.useWebWorkers=!1,zip.createWriter(new zip.BlobWriter("application/zip"),(function(r){0!=e.length&&function i(o){if(o>=e.length)r.close((function(e){t(e)}));else{var a=e[o],s=o+","+a.copies+","+a.fileName;a.serialize().then((function(e){r.add(s,e,(function(){i(o+1)}))})).catch((function(e){n(e)}))}}(0)}),(function(e){n(e)}))):n("zip.js, zip-ext.js, and deflate.js files from https://github.com/gildas-lormeau/zip.js project are missing.")}))},n.prototype._genPCArrayAsync=function(t,n){return new Promise((function(r,i){try{var o=e.Utils._str2UTF8Array(n.toString()),a=new Uint8Array(0);n>1&&((a=new Uint8Array(5+o.length)).set([80,67,67,61]),a.set(o,4),a.set([124],4+o.length)),null!=t&&t.length>0&&r(new Blob([a,t]))}catch(e){i(e)}}))},n.prototype._genPrinterArrayAsync=function(t){return new Promise((function(n,r){try{t||(t=new e.UserSelectedPrinter),n(new Uint8Array(e.Utils._str2UTF8Array(t.serialize())))}catch(e){r(e)}}))},n.prototype._cmd2bin=function(){if(this._printerCommands&&this._printerCommands.length>0)try{if(this._printerCommandsCodePage==e.Encoding.Default)this._binaryPrinterCommands=new Uint8Array(e.Utils._str2UTF8Array(this._printerCommands));else{if(!("cptable"in window))throw"cptable.js and cputils.js files from https://github.com/SheetJS/js-codepageproject are missing";if(!("utils"in window.cptable))throw"cptable.js and cputils.js files from https://github.com/SheetJS/js-codepage project are missing";if(!(this._printerCommandsCodePage in window.cptable))throw"Encoding "+this._printerCommandsCodePage.toString()+" is missing. Add it fromhttps://github.com/SheetJS/js-codepage/tree/master/bits";this._binaryPrinterCommands=new Uint8Array(cptable.utils.encode(this._printerCommandsCodePage,this._printerCommands))}}catch(e){throw e}},n.prototype._generateDataAsync=function(){var t=this;return new Promise((function(n,r){t._cmd2bin();var i=new Uint8Array([99,112,106,2]);Promise.race([t._genPCArrayAsync(t.binaryPrinterCommands,t._printerCommandsCopies),t._genPFGArrayAsync(t._printFileGroup)]).then((function(o){t._genPrinterArrayAsync(t._clientPrinter).then((function(t){var r=e.Utils._intToByteArray(o.size);n(new Blob([i,r,o,t]))})).catch((function(e){r(e)}))})).catch((function(e){r(e)}))}))},n}(e.ClientJob);e.ClientPrintJob=t}(s||(s={})),function(e){var t=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._jobs=[],e}return a(n,t),Object.defineProperty(n.prototype,"jobs",{get:function(){return this._jobs},enumerable:!0,configurable:!0}),n.prototype._generateMiniJob=function(t){return new Promise((function(n,r){t._cmd2bin(),Promise.race([t._genPCArrayAsync(t.binaryPrinterCommands,t.printerCommandsCopies),t._genPFGArrayAsync(t.files)]).then((function(i){t._genPrinterArrayAsync(t.clientPrinter).then((function(t){var r=e.Utils._intToByteArray(i.size);n(new Blob([r,i,t]))})).catch((function(e){r(e)}))})).catch((function(e){r(e)}))}))},n.prototype._generateDataAsync=function(){var t=this;return new Promise((function(n,r){for(var i=new Uint8Array([99,112,106,103,2]),o=new Uint8Array(e.Utils._intToByteArray(t.jobs.length)),a=[],s=0;s<t.jobs.length;s++)a.push(t._generateMiniJob(t.jobs[s]));Promise.all(a).then((function(t){for(var r=t.map((function(e){return{startIndex:0,endIndex:e.size-1}})),a=1;a<r.length;a++)r[a].startIndex=r[a-1].endIndex+1,r[a].endIndex+=r[a].startIndex;var s=JSON.stringify(r),c=t.reduce((function(e,t){return new Blob([e,t])})),u=new Uint8Array(e.Utils._intToByteArray(c.size));n(new Blob([i,o,u,c,s]))})).catch((function(e){r(e)}))}))},n}(e.ClientJob);e.ClientPrintJobGroup=t}(s||(s={})),function(e){var t=function(){function e(){this.Id=0}return e.prototype.serialize=function(){return JSON.stringify({type:this.Id})},e}();e.DefaultPrinter=t;var n=function(){function t(t,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=""),void 0===i&&(i=""),void 0===o&&(o=e.DuplexMode.Default),this.Id=1,this._name="",this._printDefault=!1,this._tray="",this._paper="",this._duplex=e.DuplexMode.Default,!t)throw"The specified printer name is null or empty.";this._name=t,this._printDefault=n,this._paper=i,this._tray=r,this._duplex=o}return t.prototype.bool2str=function(e,t,n){return void 0===t&&(t="1"),void 0===n&&(n="0"),e?t:n},Object.defineProperty(t.prototype,"printerName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"printToDefaultIfNotFound",{get:function(){return this._printDefault},set:function(e){this._printDefault=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trayName",{get:function(){return this._tray},set:function(e){this._tray=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paperName",{get:function(){return this._paper},set:function(e){this._paper=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duplex",{get:function(){return this._duplex},set:function(e){this._duplex=e},enumerable:!0,configurable:!0}),t.prototype.serialize=function(){if(!this._name)throw"The specified printer name is null or empty.";return JSON.stringify({type:this.Id,name:this._name,duplex:this._duplex,paper:this._paper,tray:this._tray,use_default:this._printDefault})},t}();e.InstalledPrinter=n;var r=function(){function e(e){if(this.Id=2,this._parallelPortName="LPT1",!e)throw"The specified parallel port name is null or empty.";this._parallelPortName=e}return Object.defineProperty(e.prototype,"portName",{get:function(){return this._parallelPortName},set:function(e){this._parallelPortName=e},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){if(!this.portName)throw"The specified parallel port name is null or empty.";return JSON.stringify({type:this.Id,port:this._parallelPortName})},e}();e.ParallelPortPrinter=r;var i=function(){function t(t,n,r,i,o,a){if(this.Id=3,this._port="COM1",this._baud_rate=9600,this._parity=e.Serial.Parity.None,this._stop_bits=e.Serial.StopBits.One,this._data_bits=e.Serial.DataBits.Eight,this._flow_control=e.Serial.Handshake.XOnXOff,!t)throw"The specified serial port name is null or empty.";this._port=t,this._baud_rate=n,this._parity=r,this._stop_bits=i,this._data_bits=o,this._flow_control=a}return Object.defineProperty(t.prototype,"portName",{get:function(){return this._port},set:function(e){this._port=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baudRate",{get:function(){return this._baud_rate},set:function(e){this._baud_rate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parity",{get:function(){return this._parity},set:function(e){this._parity=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stopBits",{get:function(){return this._stop_bits},set:function(e){this._stop_bits=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataBits",{get:function(){return this._data_bits},set:function(e){this._data_bits=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flowControl",{get:function(){return this._flow_control},set:function(e){this._flow_control=e},enumerable:!0,configurable:!0}),t.prototype.serialize=function(){if(!this.portName)throw"The specified serial port name is null or empty.";return JSON.stringify({type:this.Id,port:this._port,baud_rate:this._baud_rate,data_bits:this._data_bits,flow_control:this._flow_control,parity:this._parity,stop_bits:this._stop_bits})},t}();e.SerialPortPrinter=i;var o=function(){function e(e,t,n){if(this.Id=4,this._ip="0.0.0.0",this._port=0,this._dnsName="",!t&&!n)throw"You have to specify an IP address or a DNS name";t&&(this._ip=t),n&&(this._dnsName=n),this._port=e}return Object.defineProperty(e.prototype,"dnsName",{get:function(){return this._dnsName},set:function(e){this._dnsName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ipAddress",{get:function(){return this._ip},set:function(e){this._ip=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},set:function(e){if(!(e>=0&&e<=65535))throw"Invalid Port Number";this._port=Math.floor(e)},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){if(!this.dnsName&&!this.ipAddress)throw"You have to specify an IP address or a DNS name";return JSON.stringify({type:this.Id,ip:this._ip,dns:this._dnsName,port:this._port})},e}();e.NetworkPrinter=o;var a=function(){function e(){this.Id=5}return e.prototype.serialize=function(){return JSON.stringify({type:this.Id})},e}();e.UserSelectedPrinter=a}(s||(s={})),function(e){var t=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n._type="scan_job",n._scannerName="",n._pixelMode=e.PixelMode.Color,n._resolution=200,n._imageFormat=e.ScannerImageFormatOutput.JPG,n}return a(n,t),Object.defineProperty(n.prototype,"scannerName",{get:function(){return this._scannerName},set:function(e){this._scannerName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pixelMode",{get:function(){return this._pixelMode},set:function(e){this._pixelMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._resolution=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageFormat",{get:function(){return this._imageFormat},set:function(e){this._imageFormat=e},enumerable:!0,configurable:!0}),n.prototype.onFinished=function(e){},n.prototype.onError=function(e,t){},n.prototype.onUpdate=function(e,t){e.result&&this.onFinished(e)},n.prototype._generateDataAsync=function(){var e=this;return new Promise((function(t,n){e._resolution||n("Scan resolution is required"),e._scannerName||n("Scanner name is required");var r={output_image_format:e._imageFormat,pixel_mode:e._pixelMode,scanner_name:e._scannerName,resolution:e._resolution};t(JSON.stringify(r))}))},n}(e.ClientJob);e.ClientScanJob=t}(s||(s={})),function(e){!function(e){e[e.Basic=0]="Basic",e[e.Extended=1]="Extended"}(e.PrintersInfoLevel||(e.PrintersInfoLevel={})),function(e){e[e.Default=-1]="Default",e[e.IBM_EBCDIC_US_Canada=37]="IBM_EBCDIC_US_Canada",e[e.OEM_United_States=437]="OEM_United_States",e[e.IBM_EBCDIC_International=500]="IBM_EBCDIC_International",e[e.Polish_MS_DOS=620]="Polish_MS_DOS",e[e.Arabic_ASMO_708=708]="Arabic_ASMO_708",e[e.Arabic_Transparent_ASMO_Arabic_DOS=720]="Arabic_Transparent_ASMO_Arabic_DOS",e[e.OEM_Greek_formerly_437G_Greek_DOS=737]="OEM_Greek_formerly_437G_Greek_DOS",e[e.OEM_Baltic_Baltic_DOS=775]="OEM_Baltic_Baltic_DOS",e[e.OEM_Russian_Cyrillic_Euro_symbol=808]="OEM_Russian_Cyrillic_Euro_symbol",e[e.OEM_Multilingual_Latin_1_Western_European_DOS=850]="OEM_Multilingual_Latin_1_Western_European_DOS",e[e.OEM_Latin_2_Central_European_DOS=852]="OEM_Latin_2_Central_European_DOS",e[e.OEM_Cyrillic_primarily_Russian=855]="OEM_Cyrillic_primarily_Russian",e[e.OEM_Turkish_Turkish_DOS=857]="OEM_Turkish_Turkish_DOS",e[e.OEM_Multilingual_Latin_1_Euro_symbol=858]="OEM_Multilingual_Latin_1_Euro_symbol",e[e.OEM_Portuguese_Portuguese_DOS=860]="OEM_Portuguese_Portuguese_DOS",e[e.OEM_Icelandic_Icelandic_DOS=861]="OEM_Icelandic_Icelandic_DOS",e[e.OEM_Hebrew_Hebrew_DOS=862]="OEM_Hebrew_Hebrew_DOS",e[e.OEM_French_Canadian_French_Canadian_DOS=863]="OEM_French_Canadian_French_Canadian_DOS",e[e.OEM_Arabic_Arabic_864=864]="OEM_Arabic_Arabic_864",e[e.OEM_Nordic_Nordic_DOS=865]="OEM_Nordic_Nordic_DOS",e[e.OEM_Russian_Cyrillic_DOS=866]="OEM_Russian_Cyrillic_DOS",e[e.OEM_Modern_Greek_Greek_Modern_DOS=869]="OEM_Modern_Greek_Greek_Modern_DOS",e[e.IBM_EBCDIC_Multilingual_ROECE_Latin_2=870]="IBM_EBCDIC_Multilingual_ROECE_Latin_2",e[e.OEM_Cyrillic_primarily_Russian_Euro_Symbol=872]="OEM_Cyrillic_primarily_Russian_Euro_Symbol",e[e.Windows_Thai=874]="Windows_Thai",e[e.IBM_EBCDIC_Greek_Modern=875]="IBM_EBCDIC_Greek_Modern",e[e.Kamenicky_Czech_MS_DOS=895]="Kamenicky_Czech_MS_DOS",e[e.Japanese_Shift_JIS=932]="Japanese_Shift_JIS",e[e.Simplified_Chinese_GBK=936]="Simplified_Chinese_GBK",e[e.Korean=949]="Korean",e[e.Traditional_Chinese_Big5=950]="Traditional_Chinese_Big5",e[e.IBM_EBCDIC_French=1010]="IBM_EBCDIC_French",e[e.IBM_EBCDIC_Turkish_Latin_5=1026]="IBM_EBCDIC_Turkish_Latin_5",e[e.IBM_EBCDIC_Latin_1_Open_System=1047]="IBM_EBCDIC_Latin_1_Open_System",e[e.IBM_EBCDIC_Lao_1132_1133_1341=1132]="IBM_EBCDIC_Lao_1132_1133_1341",e[e.IBM_EBCDIC_US_Canada_037_Euro_symbol=1140]="IBM_EBCDIC_US_Canada_037_Euro_symbol",e[e.IBM_EBCDIC_Germany_20273_Euro_symbol=1141]="IBM_EBCDIC_Germany_20273_Euro_symbol",e[e.IBM_EBCDIC_Denmark_Norway_20277_Euro_symbol=1142]="IBM_EBCDIC_Denmark_Norway_20277_Euro_symbol",e[e.IBM_EBCDIC_Finland_Sweden_20278_Euro_symbol=1143]="IBM_EBCDIC_Finland_Sweden_20278_Euro_symbol",e[e.IBM_EBCDIC_Italy_20280_Euro_symbol=1144]="IBM_EBCDIC_Italy_20280_Euro_symbol",e[e.IBM_EBCDIC_Latin_America_Spain_20284_Euro_symbol=1145]="IBM_EBCDIC_Latin_America_Spain_20284_Euro_symbol",e[e.IBM_EBCDIC_United_Kingdom_20285_Euro_symbol=1146]="IBM_EBCDIC_United_Kingdom_20285_Euro_symbol",e[e.IBM_EBCDIC_France_20297_Euro_symbol=1147]="IBM_EBCDIC_France_20297_Euro_symbol",e[e.IBM_EBCDIC_International_500_Euro_symbol=1148]="IBM_EBCDIC_International_500_Euro_symbol",e[e.IBM_EBCDIC_Icelandic_20871_Euro_symbol=1149]="IBM_EBCDIC_Icelandic_20871_Euro_symbol",e[e.Unicode_UTF_16_little_endian_BMP_of_ISO_10646=1200]="Unicode_UTF_16_little_endian_BMP_of_ISO_10646",e[e.Unicode_UTF_16_big_endian=1201]="Unicode_UTF_16_big_endian",e[e.Windows_Central_Europe=1250]="Windows_Central_Europe",e[e.Windows_Cyrillic=1251]="Windows_Cyrillic",e[e.Windows_Latin_I=1252]="Windows_Latin_I",e[e.Windows_Greek=1253]="Windows_Greek",e[e.Windows_Turkish=1254]="Windows_Turkish",e[e.Windows_Hebrew=1255]="Windows_Hebrew",e[e.Windows_Arabic=1256]="Windows_Arabic",e[e.Windows_Baltic=1257]="Windows_Baltic",e[e.Windows_Vietnam=1258]="Windows_Vietnam",e[e.Korean_Johab=1361]="Korean_Johab",e[e.MAC_Roman=1e4]="MAC_Roman",e[e.Japanese_Mac=10001]="Japanese_Mac",e[e.MAC_Traditional_Chinese_Big5=10002]="MAC_Traditional_Chinese_Big5",e[e.Korean_Mac=10003]="Korean_Mac",e[e.Arabic_Mac=10004]="Arabic_Mac",e[e.Hebrew_Mac=10005]="Hebrew_Mac",e[e.Greek_Mac=10006]="Greek_Mac",e[e.Cyrillic_Mac=10007]="Cyrillic_Mac",e[e.MAC_Simplified_Chinese_GB_2312=10008]="MAC_Simplified_Chinese_GB_2312",e[e.Romanian_Mac=10010]="Romanian_Mac",e[e.Ukrainian_Mac=10017]="Ukrainian_Mac",e[e.Thai_Mac=10021]="Thai_Mac",e[e.MAC_Latin_2_Central_European=10029]="MAC_Latin_2_Central_European",e[e.Icelandic_Mac=10079]="Icelandic_Mac",e[e.Turkish_Mac=10081]="Turkish_Mac",e[e.Croatian_Mac=10082]="Croatian_Mac",e[e.Unicode_UTF_32_little_endian_byte_order=12e3]="Unicode_UTF_32_little_endian_byte_order",e[e.Unicode_UTF_32_big_endian_byte_order=12001]="Unicode_UTF_32_big_endian_byte_order",e[e.CNS_Taiwan_Chinese_Traditional=2e4]="CNS_Taiwan_Chinese_Traditional",e[e.TCA_Taiwan=20001]="TCA_Taiwan",e[e.ETEN_Taiwan_Chinese_Traditional=20002]="ETEN_Taiwan_Chinese_Traditional",e[e.IBM5550_Taiwan=20003]="IBM5550_Taiwan",e[e.TeleText_Taiwan=20004]="TeleText_Taiwan",e[e.Wang_Taiwan=20005]="Wang_Taiwan",e[e.Western_European_IA5_IRV_International_Alphabet_5=20105]="Western_European_IA5_IRV_International_Alphabet_5",e[e.IA5_German_7_bit=20106]="IA5_German_7_bit",e[e.IA5_Swedish_7_bit=20107]="IA5_Swedish_7_bit",e[e.IA5_Norwegian_7_bit=20108]="IA5_Norwegian_7_bit",e[e.US_ASCII_7_bit=20127]="US_ASCII_7_bit",e[e.T_61=20261]="T_61",e[e.ISO_6937_Non_Spacing_Accent=20269]="ISO_6937_Non_Spacing_Accent",e[e.IBM_EBCDIC_Germany=20273]="IBM_EBCDIC_Germany",e[e.IBM_EBCDIC_Denmark_Norway=20277]="IBM_EBCDIC_Denmark_Norway",e[e.IBM_EBCDIC_Finland_Sweden=20278]="IBM_EBCDIC_Finland_Sweden",e[e.IBM_EBCDIC_Italy=20280]="IBM_EBCDIC_Italy",e[e.IBM_EBCDIC_Latin_America_Spain=20284]="IBM_EBCDIC_Latin_America_Spain",e[e.IBM_EBCDIC_United_Kingdom=20285]="IBM_EBCDIC_United_Kingdom",e[e.IBM_EBCDIC_Japanese_Katakana_Extended=20290]="IBM_EBCDIC_Japanese_Katakana_Extended",e[e.IBM_EBCDIC_France=20297]="IBM_EBCDIC_France",e[e.IBM_EBCDIC_Arabic=20420]="IBM_EBCDIC_Arabic",e[e.IBM_EBCDIC_Greek=20423]="IBM_EBCDIC_Greek",e[e.IBM_EBCDIC_Hebrew=20424]="IBM_EBCDIC_Hebrew",e[e.IBM_EBCDIC_Korean_Extended=20833]="IBM_EBCDIC_Korean_Extended",e[e.IBM_EBCDIC_Thai=20838]="IBM_EBCDIC_Thai",e[e.Russian_Cyrillic_KOI8_R=20866]="Russian_Cyrillic_KOI8_R",e[e.IBM_EBCDIC_Icelandic=20871]="IBM_EBCDIC_Icelandic",e[e.IBM_EBCDIC_Cyrillic_Russian=20880]="IBM_EBCDIC_Cyrillic_Russian",e[e.IBM_EBCDIC_Turkish=20905]="IBM_EBCDIC_Turkish",e[e.IBM_EBCDIC_Latin_1_Open_System_1047_Euro_symbol=20924]="IBM_EBCDIC_Latin_1_Open_System_1047_Euro_symbol",e[e.Japanese_JIS_0208_1990_and_0212_1990=20932]="Japanese_JIS_0208_1990_and_0212_1990",e[e.Simplified_Chinese_GB2312_80=20936]="Simplified_Chinese_GB2312_80",e[e.Korean_Wansung=20949]="Korean_Wansung",e[e.IBM_EBCDIC_Cyrillic_Serbian_Bulgarian=21025]="IBM_EBCDIC_Cyrillic_Serbian_Bulgarian",e[e.Extended_Ext_Alpha_Lowercase=21027]="Extended_Ext_Alpha_Lowercase",e[e.Ukrainian_Cyrillic_KOI8_U=21866]="Ukrainian_Cyrillic_KOI8_U",e[e.ISO_8859_1_Latin_1_Western_European=28591]="ISO_8859_1_Latin_1_Western_European",e[e.ISO_8859_2_Latin_2_Central_European=28592]="ISO_8859_2_Latin_2_Central_European",e[e.ISO_8859_3_Latin_3=28593]="ISO_8859_3_Latin_3",e[e.ISO_8859_4_Baltic=28594]="ISO_8859_4_Baltic",e[e.ISO_8859_5_Cyrillic=28595]="ISO_8859_5_Cyrillic",e[e.ISO_8859_6_Arabic=28596]="ISO_8859_6_Arabic",e[e.ISO_8859_7_Greek=28597]="ISO_8859_7_Greek",e[e.ISO_8859_8_Hebrew_ISO_Visual=28598]="ISO_8859_8_Hebrew_ISO_Visual",e[e.ISO_8859_9_Turkish=28599]="ISO_8859_9_Turkish",e[e.ISO_8859_10_Latin_6=28600]="ISO_8859_10_Latin_6",e[e.ISO_8859_11_Latin_Thai=28601]="ISO_8859_11_Latin_Thai",e[e.ISO_8859_13_Latin_7_Estonian=28603]="ISO_8859_13_Latin_7_Estonian",e[e.ISO_8859_14_Latin_8_Celtic=28604]="ISO_8859_14_Latin_8_Celtic",e[e.ISO_8859_15_Latin_9=28605]="ISO_8859_15_Latin_9",e[e.ISO_8859_15_Latin_10=28606]="ISO_8859_15_Latin_10",e[e.Europa_3=29001]="Europa_3",e[e.ISO_8859_8_Hebrew_ISO_Logical=38598]="ISO_8859_8_Hebrew_ISO_Logical",e[e.Atari_ST_TT=47451]="Atari_ST_TT",e[e.ISO_2022_JIS_Japanese_with_no_halfwidth_Katakana=50220]="ISO_2022_JIS_Japanese_with_no_halfwidth_Katakana",e[e.ISO_2022_JIS_Japanese_with_halfwidth_Katakana=50221]="ISO_2022_JIS_Japanese_with_halfwidth_Katakana",e[e.ISO_2022_Japanese_JIS_X_0201_1989_1_byte_Kana_SO_SI=50222]="ISO_2022_Japanese_JIS_X_0201_1989_1_byte_Kana_SO_SI",e[e.ISO_2022_Korean=50225]="ISO_2022_Korean",e[e.ISO_2022_Simplified_Chinese=50227]="ISO_2022_Simplified_Chinese",e[e.EUC_Japanese=51932]="EUC_Japanese",e[e.EUC_Simplified_Chinese=51936]="EUC_Simplified_Chinese",e[e.EUC_Korean=51949]="EUC_Korean",e[e.HZ_GB2312_Simplified_Chinese=52936]="HZ_GB2312_Simplified_Chinese",e[e.GB18030_Simplified_Chinese_4_byte=54936]="GB18030_Simplified_Chinese_4_byte",e[e.ISCII_Devanagari=57002]="ISCII_Devanagari",e[e.ISCII_Bengali=57003]="ISCII_Bengali",e[e.ISCII_Tamil=57004]="ISCII_Tamil",e[e.ISCII_Telugu=57005]="ISCII_Telugu",e[e.ISCII_Assamese=57006]="ISCII_Assamese",e[e.ISCII_Oriya=57007]="ISCII_Oriya",e[e.ISCII_Kannada=57008]="ISCII_Kannada",e[e.ISCII_Malayalam=57009]="ISCII_Malayalam",e[e.ISCII_Gujarati=57010]="ISCII_Gujarati",e[e.ISCII_Punjabi=57011]="ISCII_Punjabi",e[e.Unicode_UTF_7=65e3]="Unicode_UTF_7",e[e.Unicode_UTF_8=65001]="Unicode_UTF_8"}(e.Encoding||(e.Encoding={})),function(e){e[e.Default=0]="Default",e[e.Simplex=1]="Simplex",e[e.DuplexLongEdge=2]="DuplexLongEdge",e[e.DuplexShortEdge=3]="DuplexShortEdge"}(e.DuplexMode||(e.DuplexMode={})),function(e){e[e.None=0]="None",e[e.Fit=1]="Fit"}(e.Sizing||(e.Sizing={})),function(e){e[e.JPG=0]="JPG",e[e.PNG=1]="PNG"}(e.ScannerImageFormatOutput||(e.ScannerImageFormatOutput={})),function(e){e[e.Grayscale=0]="Grayscale",e[e.Color=1]="Color"}(e.PixelMode||(e.PixelMode={})),function(e){e[e.Base64=0]="Base64",e[e.Text=1]="Text",e[e.BLOB=2]="BLOB",e[e.URL=3]="URL"}(e.FileSourceType||(e.FileSourceType={})),function(e){e[e.Open=0]="Open",e[e.Closed=1]="Closed",e[e.Blocked=2]="Blocked",e[e.WaitingForUserResponse=3]="WaitingForUserResponse"}(e.WSStatus||(e.WSStatus={})),function(e){e[e.None=0]="None",e[e.Rot90=1]="Rot90",e[e.Rot180=2]="Rot180",e[e.Rot270=3]="Rot270"}(e.PrintRotation||(e.PrintRotation={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify",e[e.None=4]="None"}(e.TextAlignment||(e.TextAlignment={})),function(e){e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape"}(e.PrintOrientation||(e.PrintOrientation={}))}(s||(s={})),function(e){!function(e){!function(e){e[e.None=0]="None",e[e.Odd=1]="Odd",e[e.Even=2]="Even",e[e.Mark=3]="Mark",e[e.Space=4]="Space"}(e.Parity||(e.Parity={})),function(e){e[e.One=0]="One",e[e.OnePointFive=1]="OnePointFive",e[e.Two=2]="Two"}(e.StopBits||(e.StopBits={})),function(e){e[e.Eight=0]="Eight",e[e.Seven=1]="Seven",e[e.Six=2]="Six",e[e.Five=3]="Five"}(e.DataBits||(e.DataBits={})),function(e){e[e.None=0]="None",e[e.RequestToSend=1]="RequestToSend",e[e.RequestToSendXOnXOff=2]="RequestToSendXOnXOff",e[e.XOnXOff=3]="XOnXOff"}(e.Handshake||(e.Handshake={}))}(e.Serial||(e.Serial={}))}(s||(s={}));var s,c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(e){var t=function(){function t(t,n,r,i){void 0===t&&(t="localhost"),void 0===n&&(n=23443),void 0===r&&(r=!0),void 0===i&&(i=!1),this._job_list=[],this._processing_message=new e.Mutex,this.autoReconnect=!1,this.onClose=function(e){},this.onOpen=function(e){},this.onStatusChanged=function(){},this._addr=t,this._port=n,this._secure=r,this.autoReconnect=i}return Object.defineProperty(t.prototype,"address",{get:function(){return this._addr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSecure",{get:function(){return this._secure},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),t.prototype._onOpen=function(t,n){this._status=e.WSStatus.WaitingForUserResponse,this._pingPong(),n.onStatusChanged(),n.onOpen(t)},t.prototype._onMessage=function(e){return c(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,l,p,f;return u(this,(function(u){switch(u.label){case 0:return[4,this._processing_message.lock()];case 1:t=u.sent(),u.label=2;case 2:if(u.trys.push([2,6,7,8]),"string"!=typeof e.data)return[3,3];if(n=JSON.parse(e.data),!(f=this._job_list[n.id]))throw"Job "+n.id+" doesn't exist";switch(r="last"in n&&n.last,i="type"in n?n.type:"message",o="data"in n?n.data:{},i){case"message":f.on_update&&(f.on_update,1)&&f.on_update(o,f.first_update,r);break;case"error":a="critical"in n&&n.critical,f.on_error&&(f.on_error,1)&&f.on_error(o,f.first_update,a);break;default:f.on_update&&(f.on_update,1)&&f.on_update(o,f.first_update,r)}return r&&delete this._job_list[n.id],[3,5];case 3:return[4,(s=e.data).slice(s.size-8,s.size).arrayBuffer()];case 4:if(c=u.sent(),l=new TextDecoder("utf-8").decode(c),p=s.slice(0,s.size-8),!(f=this._job_list[l]))throw"Job "+l+" doesn't exist";f.on_update&&(f.on_update,1)&&f.on_update(p,f.first_update,!1),u.label=5;case 5:return f.first_update=!1,[3,8];case 6:throw"Malformed message. Error: "+u.sent()+" Message: "+e.data;case 7:return t(),[7];case 8:return[2]}}))}))},t.prototype._onError=function(e){try{var t=JSON.parse(e),n=this._job_list[t.id];if(!n)throw e;n.on_error(e,!0,!0)}catch(t){throw e}},t.prototype._pingPong=function(){var t=this;setInterval((function(n){t._status==e.WSStatus.Open&&t.send("",{type:"ping",on_update:function(e){},on_error:function(e){}})}),3e4)},t.prototype._onClose=function(t,n){var r=this;403==t.code?this._status=e.WSStatus.Blocked:(this._status=e.WSStatus.Closed,this.autoReconnect&&setTimeout((function(e){r.start()}),2e3)),n.onClose(t),n.onStatusChanged()},t.prototype._genID=function(){return Math.floor(4294967296*(1+Math.random())).toString(16).substring(1)},t.prototype._send=function(e,t){var n="";if("id"in t)n=t.id;else{do{n=this._genID()}while(this._job_list[n]);this._job_list[n]={id:n,first_update:!0,on_update:t.on_update,on_error:t.on_error}}var r="";if(e instanceof Blob){var i=new Uint8Array(("id"+n).split("").map((function(e){return e.charCodeAt(0)})));r=new Blob([e,i])}else"string"==typeof e?(r={id:n,data:e},"type"in t&&(r.type=t.type),r=JSON.stringify(r)):(delete this._job_list[n],r=e);return this._ws.send(r),n},t.prototype.start=function(){var t=this;return new Promise((function(n,r){try{t._ws=new WebSocket((t._secure?"wss://":"ws://")+t._addr+":"+t._port),t._ws.onclose=function(e){return t._onClose(e,t)},t._ws.onerror=function(e){r(e)},t._ws.onopen=function(i){t._ws.onopen=function(e){return t._onOpen(e,t)},t._ws.onmessage=function(i){try{var o=JSON.parse(i.data);if("connection"in o)if("CONNECTED"==o.connection){t._status=e.WSStatus.Open,t.onStatusChanged(),t.onOpen(o.certificate),e.JSPrintManager._ses_cert=o.certificate,t.send(JSON.stringify({url:e.JSPrintManager.license_url}),{type:"set_license",on_update:function(e){console.info("JSPrintManager License:","result"in e?e.result:e)},on_error:function(e){console.warn("JSPrintManager License:","result"in e?e.result:e)}});var a=o.version.split(".");a[0]+"."+a[1]!=e.VERSION&&console.warn("Lib JS version and desktop version differs Desktop("+o.version+") JS ("+e.VERSION+")"),t._ws.onmessage=function(e){return c(t,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this._onMessage(e)];case 1:return t.sent(),[2]}}))}))},t._ws.onerror=t._onError,n()}else r("WS Connection not established. Reason: "+o.connection)}catch(i){r("Malformed message. Check if JS version and Desktop version are the same. Description: "+i)}}}}catch(e){t.autoReconnect?setTimeout((function(){t.start().then(n).catch(r)}),2e3):r(e)}}))},t.prototype.send=function(t,n){return this._status==e.WSStatus.Closed?n.on_first_error("The WebSocket connection is closed"):this._status==e.WSStatus.Blocked?n.on_first_error("The site is blocked and the connection was closed"):this._ws.readyState!=this._ws.OPEN&&n.on_first_error("The WebSocket isn't ready yet"),this._send(t,n)},t.prototype.stop=function(){this._ws.close(),this._ws=null},t}();e.JSPMWebSocket=t}(s||(s={})),function(e){var t=function(){function t(){}return Object.defineProperty(t,"session_certificate",{get:function(){return this._ses_cert},enumerable:!0,configurable:!0}),t.start=function(t,n,r){return void 0===t&&(t=!0),void 0===n&&(n="localhost"),void 0===r&&(r=23443),c(this,void 0,void 0,(function(){return u(this,(function(i){switch(i.label){case 0:return this.WS||(this.WS=new e.JSPMWebSocket(n,r,t,this.auto_reconnect)),[4,this.WS.start()];case 1:return[2,i.sent()]}}))}))},Object.defineProperty(t,"license_url",{get:function(){return this._license},set:function(t){this._license=t,this.WS&&this.WS.status==e.WSStatus.Open&&this.WS.send(JSON.stringify({url:this._license}),{type:"set_license",on_update:function(e){},on_error:function(e){}})},enumerable:!0,configurable:!0}),t.getPrinters=function(){var e=this;return new Promise((function(t,n){e.WS.send("",{type:"printers_list",on_update:function(e){t(e&&"result"in e?e.result:e)},on_error:function(e){return n(e)}})}))},t.getPrintersInfo=function(t,n){var r=this;return void 0===t&&(t=e.PrintersInfoLevel.Basic),void 0===n&&(n=""),new Promise((function(e,i){var o={detail_level:t};n&&(o.printer=n),r.WS.send(JSON.stringify(o),{type:"printers_complete_list",on_update:function(t){e(t&&"result"in t?t.result:t)},on_error:function(e){return i(e)}})}))},Object.defineProperty(t,"websocket_status",{get:function(){return this.WS?this.WS.status:e.WSStatus.Closed},enumerable:!0,configurable:!0}),t.showAbout=function(){var e=this;return new Promise((function(t,n){e.WS.send("",{type:"about",on_update:function(e){t(e&&"result"in e?e.result:e)},on_error:function(e){return n(e)}})}))},t.updateClient=function(){var e=this;return new Promise((function(t,n){e.WS.send("",{type:"update",on_update:function(e){t(e&&"result"in e?e.result:e)},on_error:function(e){return n(e)}})}))},t.getSystemFonts=function(){var e=this;return new Promise((function(t,n){e.WS.send("",{type:"fonts_list",on_update:function(e){t(e&&"result"in e?e.result:e)},on_error:function(e){return n(e)}})}))},t.getSerialPorts=function(){var e=this;return new Promise((function(t,n){e.WS.send("",{type:"serial_ports_list",on_update:function(e){t(e&&"result"in e?e.result:e)},on_error:function(e){return n(e)}})}))},t.getScanners=function(){var e=this;return new Promise((function(t,n){e.WS.send("",{type:"scanner_list",on_update:function(e){t(e&&"result"in e?e.result:e)},on_error:function(e){return n(e)}})}))},t.onPrinterCreated=function(t,n,r){if(void 0===r&&(r=e.PrintersInfoLevel.Extended),r==e.PrintersInfoLevel.Basic)throw"Basic detail level information is not implemented yet";if(navigator.platform.toLowerCase().indexOf("win")<0)throw"This functionality is Windows only";return this.WS.send("",{type:"on_printer_creation",on_update:function(e){return t(e)},on_error:function(e){return n(e)}})},t.onPrinterUpdated=function(t,n,r){if(void 0===r&&(r=e.PrintersInfoLevel.Extended),r==e.PrintersInfoLevel.Basic)throw"Basic detail level information is not implemented yet";if(navigator.platform.toLowerCase().indexOf("win")<0)throw"This functionality is Windows only";return this.WS.send("",{type:"on_printer_modification",on_update:function(e){return t(e)},on_error:function(e){return n(e)}})},t.onPrinterDeleted=function(t,n,r){if(void 0===r&&(r=e.PrintersInfoLevel.Extended),r==e.PrintersInfoLevel.Basic)throw"Basic detail level information is not implemented yet";if(navigator.platform.toLowerCase().indexOf("win")<0)throw"This functionality is Windows only";return this.WS.send("",{type:"on_printer_deletion",on_update:function(e){return t(e)},on_error:function(e){return n(e)}})},t.unsubscribePrinterEvent=function(e){var t=this;return new Promise((function(n,r){return t.WS.send(JSON.stringify({close:!0}),{id:e,type:"on_printer_deletion",on_update:function(e){return n(e)},on_error:function(e){return r(e)}})}))},t.stop=function(){this.WS.stop()},t.auto_reconnect=!1,t._license=document.location.origin+"/jspm",t._ses_cert="",t}();e.JSPrintManager=t}(s||(s={})),function(e){var t=function(){function t(e,t,n,r){if(this.fileName="",this._copies=1,this.fileContent=e,this.fileContentType=t,!n)throw"You must specify a FileName including the extension.";this.fileName=n,r&&(this.copies=r),this.escapeInvalidFileNameChars()}return Object.defineProperty(t.prototype,"copies",{get:function(){return this._copies},set:function(e){if(e<1)throw"Copies must be greater than or equal to 1.";this._copies=e},enumerable:!0,configurable:!0}),t.prototype.escapeInvalidFileNameChars=function(){this.fileName.indexOf("\\")>-1&&(this.fileName=this.fileName.replace("\\","BACKSLASHCHAR"))},t.prototype.bool2str=function(e,t,n){return void 0===t&&(t="1"),void 0===n&&(n="0"),e?t:n},t.prototype.getBLOBContent=function(){var t=this;return new Promise((function(n,r){switch(t.fileContentType){case e.FileSourceType.BLOB:n(t.fileContent);break;case e.FileSourceType.Base64:try{for(var i=atob(t.fileContent),o=new Uint8Array(i.length),a=0;a<i.length;a++)o[a]=i.charCodeAt(a);n(new Blob([o]))}catch(e){r("Error trying to decode the base64 data.\n"+e)}break;case e.FileSourceType.Text:try{for(o=new Uint8Array(t.fileContent.length),a=0;a<t.fileContent.length;a++)o[a]=t.fileContent.charCodeAt(a);n(new Blob([o]))}catch(e){r("Error trying to decode the text data.\n"+e)}break;case e.FileSourceType.URL:var s=new XMLHttpRequest;s.open("GET",t.fileContent,!0),s.responseType="blob",s.onload=function(e){n(s.response)},s.send(null);break;default:r("FileSourceType not specified")}}))},t.prototype.serialize=function(){var t=this;return new Promise((function(n,r){switch(t.fileContentType){case e.FileSourceType.Base64:n(new zip.Data64URIReader(t.fileContent));break;case e.FileSourceType.BLOB:n(new zip.BlobReader(t.fileContent));break;case e.FileSourceType.Text:n(new zip.TextReader(t.fileContent));break;case e.FileSourceType.URL:var i=new XMLHttpRequest;i.open("GET",t.fileContent,!0),i.responseType="blob",i.onload=function(e){n(new zip.BlobReader(i.response))},i.send(null);break;default:r("The file content type is invalid")}}))},t}();e.PrintFile=t}(s||(s={})),function(e){var t=function(t){function n(e,n,r,i){var o=t.call(this,e,n,r.substring(0,r.lastIndexOf("."))+".wdoc",i)||this;return o.manualDuplex=!1,o.manualDuplexMessage="",o.printInReverseOrder=!1,o.printRange="",o.encryptedPassword="",o}return a(n,t),n.prototype.isValidRange=function(e){if(null==e||""==e)return!0;var t=/([0-9])+((-[0-9]+)|(,[0-9]+))*/.exec(e);return null!=t&&t[0].length==e.length},n.prototype._getPropertiesJSON=function(){return{manual_duplex:this.manualDuplex,reverse:this.printInReverseOrder,duplex_message:this.manualDuplexMessage,range:this.printRange,password:this.encryptedPassword}},n.prototype.serialize=function(){var t=this;return new Promise((function(n,r){t.isValidRange(t.printRange)||r("Invalid Print Range"),t.getBLOBContent().then((function(r){var i=new Uint8Array(e.Utils._str2UTF8Array(JSON.stringify(t._getPropertiesJSON()))),o=e.Utils._intToByteArray(i.length),a=new Blob([r,i,o]);n(new zip.BlobReader(a))})).catch((function(e){r(e)}))}))},n}(e.PrintFile);e.PrintFileDOC=t}(s||(s={})),function(e){var t=function(t){function n(n,r,i,o){var a=t.call(this,n,r,i.substring(0,i.lastIndexOf("."))+".wpdf",o)||this;return a.pageSizing=e.Sizing.None,a.manualDuplex=!1,a.printAutoRotate=!1,a.printAutoCenter=!1,a.manualDuplexMessage="",a.encryptedPassword="",a.printAsGrayscale=!1,a.printAnnotations=!1,a.printRange="",a.printInReverseOrder=!1,a.printRotation=e.PrintRotation.None,a}return a(n,t),n.prototype.isValidRange=function(e){if(null==e||""==e)return!0;var t=/([0-9])+((-[0-9]+)|(,[0-9]+))*/.exec(e);return null!=t&&t[0].length==e.length},n.prototype._getPropertiesJSON=function(){return{manual_duplex:this.manualDuplex,grayscale:this.printAsGrayscale,annotations:this.printAnnotations,reverse:this.printInReverseOrder,auto_rotate:this.printAutoRotate,auto_center:this.printAutoCenter,duplex_message:this.manualDuplexMessage,range:this.printRange,password:this.encryptedPassword,rotation:this.printRotation,sizing:this.pageSizing}},n.prototype.serialize=function(){var t=this;return new Promise((function(n,r){t.isValidRange(t.printRange)||r("Invalid Print Range"),t.getBLOBContent().then((function(r){var i=new Uint8Array(e.Utils._str2UTF8Array(JSON.stringify(t._getPropertiesJSON()))),o=e.Utils._intToByteArray(i.length),a=new Blob([r,i,o]);n(new zip.BlobReader(a))})).catch((function(e){r(e)}))}))},n}(e.PrintFile);e.PrintFilePDF=t}(s||(s={})),function(e){var t=function(t){function n(n,r,i,o){var a=t.call(this,n,o||e.FileSourceType.Text,r.substring(0,r.lastIndexOf("."))+".wtxt",i)||this;return a.textContent="",a.textAligment=e.TextAlignment.Left,a.fontName="",a.fontBold=!1,a.fontItalic=!1,a.fontUnderline=!1,a.fontStrikethrough=!1,a.fontSize=10,a.fontColor="#000000",a.printOrientation=e.PrintOrientation.Portrait,a.marginLeft=.5,a.marginRight=.5,a.marginTop=.5,a.marginBottom=.5,a}return a(n,t),n.prototype.serialize=function(){var t=this;return new Promise((function(n,r){t.getBLOBContent().then((function(r){var i=new Uint8Array(e.Utils._str2UTF8Array(t.printOrientation+"|"+t.textAligment+"|"+t.fontName+"|"+t.fontSize+"|"+t.bool2str(t.fontBold)+"|"+t.bool2str(t.fontItalic)+"|"+t.bool2str(t.fontUnderline)+"|"+t.bool2str(t.fontStrikethrough)+"|"+t.fontColor+"|"+t.marginLeft+"|"+t.marginTop+"|"+t.marginRight+"|"+t.marginBottom+"\n")),o=new Blob([i,r]);n(new zip.BlobReader(o))})).catch((function(e){r(e)}))}))},n}(e.PrintFile);e.PrintFileTXT=t}(s||(s={})),function(e){var t=function(t){function n(e,n,r,i){var o=t.call(this,e,n,r.substring(0,r.lastIndexOf("."))+".wxls",i)||this;return o.encryptedPassword="",o.pageFrom=0,o.pageTo=0,o}return a(n,t),n.prototype._getPropertiesJSON=function(){return{from:this.pageFrom,to:this.pageTo,password:this.encryptedPassword}},n.prototype.serialize=function(){var t=this;return new Promise((function(n,r){t.getBLOBContent().then((function(r){var i=new Uint8Array(e.Utils._str2UTF8Array(JSON.stringify(t._getPropertiesJSON()))),o=e.Utils._intToByteArray(i.length),a=new Blob([r,i,o]);n(new zip.BlobReader(a))})).catch((function(e){r(e)}))}))},n}(e.PrintFile);e.PrintFileXLS=t}(s||(s={})),function(e){var t=function(){function t(t,n,r,i,o,a){if(this._id="",this._isOpen=!1,this._port="",this._baud_rate=9600,this._parity=e.Serial.Parity.None,this._stop_bits=e.Serial.StopBits.One,this._data_bits=e.Serial.DataBits.Eight,this._flow_control=e.Serial.Handshake.XOnXOff,!t)throw"The specified serial port name is null or empty.";this._port=t,this._baud_rate=n,this._parity=r,this._stop_bits=i,this._data_bits=o,this._flow_control=a}return Object.defineProperty(t.prototype,"portName",{get:function(){return this._port},set:function(e){this._port=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baudRate",{get:function(){return this._baud_rate},set:function(e){this._baud_rate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parity",{get:function(){return this._parity},set:function(e){this._parity=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stopBits",{get:function(){return this._stop_bits},set:function(e){this._stop_bits=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataBits",{get:function(){return this._data_bits},set:function(e){this._data_bits=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flowControl",{get:function(){return this._flow_control},set:function(e){this._flow_control=e},enumerable:!0,configurable:!0}),t.prototype.onError=function(e,t){},t.prototype.onDataReceived=function(e){},t.prototype.onClose=function(e){},t.prototype.open=function(){var t=this;return new Promise((function(n,r){if(t._isOpen)throw"Connection is already open";var i=t.propertiesJSON();i.on_update=function(e,r,i){r?(e.result&&"Open"==e.result&&0==t._isOpen&&(t._isOpen=!0),n(e)):i?(t.onClose(e),t._id="",t._isOpen=!1):t.onDataReceived(e.data)},i.on_error=function(e,n,i){n?r(e):t.onError(e,i)},t._id=e.JSPrintManager.WS.send(JSON.stringify({port:t._port,baud_rate:t._baud_rate,data_bits:t._data_bits,flow_control:t._flow_control,parity:t._parity,stop_bits:t._stop_bits}),i)}))},t.prototype.send=function(t){var n=this.propertiesJSON();e.JSPrintManager.WS.send(JSON.stringify({data:t}),n)},t.prototype.close=function(){e.JSPrintManager.WS.send(JSON.stringify({close:!0}),this.propertiesJSON())},t.prototype.propertiesJSON=function(){if(!this.portName)throw"The specified serial port name is null or empty.";var e={type:"serial"};return this._id&&(e.id=this._id),e},t}();e.SerialComm=t}(s||(s={})),function(e){e.VERSION="3.0";var t=function(){function e(){this.mutex=Promise.resolve()}return e.prototype.lock=function(){var e=function(e){};return this.mutex=this.mutex.then((function(){return new Promise(e)})),new Promise((function(t){e=t}))},e}();e.Mutex=t;var n=function(){function e(){}return e._intToByteArray=function(e){return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])},e._str2UTF8Array=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);0==n&&239==r&&n+1<e.length&&187==e.charCodeAt(n+1)&&n+2<e.length&&191==e.charCodeAt(n+2)?(t.push(239),t.push(187),t.push(191),n+=2):r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&e.charCodeAt(n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},e}();e.Utils=n}(s||(s={})),void 0===(i="function"==typeof(r=s)?r.call(t,n,t,e):r)||(e.exports=i)},function(e,t,n){"use strict";!function(e){var t,n="File format is not recognized.",r="Error while reading zip file.";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}function i(){this.crc=-1}function o(){}function a(e,t){var n,r;return n=new ArrayBuffer(e),r=new Uint8Array(n),t&&r.set(t,0),{buffer:n,array:r,view:new DataView(n)}}function s(){}function c(e){var t,n=this;n.size=0,n.init=function(r,i){var o=new Blob([e],{type:"text/plain"});(t=new l(o)).init((function(){n.size=t.size,r()}),i)},n.readUint8Array=function(e,n,r,i){t.readUint8Array(e,n,r,i)}}function u(t){var n,r=this;r.size=0,r.init=function(e){for(var i=t.length;"="==t.charAt(i-1);)i--;n=t.indexOf(",")+1,r.size=Math.floor(.75*(i-n)),e()},r.readUint8Array=function(r,i,o){var s,c=a(i),u=4*Math.floor(r/3),l=4*Math.ceil((r+i)/3),p=e.atob(t.substring(u+n,l+n)),f=r-3*Math.floor(u/4);for(s=f;s<f+i;s++)c.array[s-f]=p.charCodeAt(s);o(c.array)}}function l(e){var t=this;t.size=0,t.init=function(n){t.size=e.size,n()},t.readUint8Array=function(t,n,r,i){var o=new FileReader;o.onload=function(e){r(new Uint8Array(e.target.result))},o.onerror=i;try{o.readAsArrayBuffer(function(e,t,n){if(t<0||n<0||t+n>e.size)throw new RangeError("offset:"+t+", length:"+n+", size:"+e.size);return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}(e,t,n))}catch(e){i(e)}}}function p(){}function f(e){var n;this.init=function(e){n=new Blob([],{type:"text/plain"}),e()},this.writeUint8Array=function(e,r){n=new Blob([n,t?e:e.buffer],{type:"text/plain"}),r()},this.getData=function(t,r){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=r,i.readAsText(n,e)}}function h(t){var n="",r="";this.init=function(e){n+="data:"+(t||"")+";base64,",e()},this.writeUint8Array=function(t,i){var o,a=r.length,s=r;for(r="",o=0;o<3*Math.floor((a+t.length)/3)-a;o++)s+=String.fromCharCode(t[o]);for(;o<t.length;o++)r+=String.fromCharCode(t[o]);s.length>2?n+=e.btoa(s):r=s,i()},this.getData=function(t){t(n+e.btoa(r))}}function d(e){var n;this.init=function(t){n=new Blob([],{type:e}),t()},this.writeUint8Array=function(r,i){n=new Blob([n,t?r:r.buffer],{type:e}),i()},this.getData=function(e){e(n)}}function _(e,t,n,r,i,o,a,s,c,u){var l,p,f,h=0,d=t.sn;function _(){e.removeEventListener("message",y,!1),s(p,f)}function y(t){var n=t.data,i=n.data,s=n.error;if(s)return s.toString=function(){return"Error: "+this.message},void c(s);if(n.sn===d)switch("number"==typeof n.codecTime&&(e.codecTime+=n.codecTime),"number"==typeof n.crcTime&&(e.crcTime+=n.crcTime),n.type){case"append":i?(p+=i.length,r.writeUint8Array(i,(function(){m()}),u)):m();break;case"flush":f=n.crc,i?(p+=i.length,r.writeUint8Array(i,(function(){_()}),u)):_();break;case"progress":a&&a(l+n.loaded,o);break;case"importScripts":case"newTask":case"echo":break;default:console.warn("zip.js:launchWorkerProcess: unknown message: ",n)}}function m(){(l=524288*h)<=o?n.readUint8Array(i+l,Math.min(524288,o-l),(function(n){a&&a(l,o);var r=0===l?t:{sn:d};r.type="append",r.data=n;try{e.postMessage(r,[n.buffer])}catch(t){e.postMessage(r)}h++}),c):e.postMessage({sn:d,type:"flush"})}p=0,e.addEventListener("message",y,!1),m()}function y(e,t,n,r,o,a,s,c,u,l){var p,f=0,h=0,d="input"===a,_="output"===a,y=new i;!function i(){var a;if((p=524288*f)<o)t.readUint8Array(r+p,Math.min(524288,o-p),(function(t){var r;try{r=e.append(t,(function(e){s&&s(p+e,o)}))}catch(e){return void u(e)}r?(h+=r.length,n.writeUint8Array(r,(function(){f++,setTimeout(i,1)}),l),_&&y.append(r)):(f++,setTimeout(i,1)),d&&y.append(t),s&&s(p,o)}),u);else{try{a=e.flush()}catch(e){return void u(e)}a?(_&&y.append(a),h+=a.length,n.writeUint8Array(a,(function(){c(h,y.get())}),l)):c(h,y.get())}}()}function m(t,n,r,i,a,s,c,u,l,p,f){e.zip.useWebWorkers&&c?_(t,{sn:n,codecClass:"NOOP",crcType:"input"},r,i,a,s,l,u,p,f):y(new o,r,i,a,s,"input",l,u,p,f)}function g(e){var t,n,r="",i=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","_","_","","","","","","","","","+","+","","","+","+","-","-","+","-","+","","","+","+","-","-","","-","+","","","","","","","i","","","","+","+","_","_","","","_","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","_"," "];for(t=0;t<e.length;t++)r+=(n=255&e.charCodeAt(t))>127?i[n-128]:String.fromCharCode(n);return r}function b(e){return decodeURIComponent(escape(e))}function v(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function w(e,t,n,r,i){e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(e){}}(e.lastModDateRaw),1!=(1&e.bitFlag)?((r||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(n+22,!0),e.extraFieldLength=t.view.getUint16(n+24,!0)):i("File is using Zip64 (4gb+ file size).")):i("File contains encrypted entry.")}function S(t,i,o){var s=0;function c(){}c.prototype.getData=function(r,i,c,u){var l=this;function p(e,t){u&&!function(e){var t=a(4);return t.view.setUint32(0,e),l.crc32==t.view.getUint32(0)}(t)?o("CRC failed."):r.getData((function(e){i(e)}))}function f(e){o(e||"Error while reading file data.")}function h(e){o(e||"Error while writing file data.")}t.readUint8Array(l.offset,30,(function(i){var d,g=a(i.length,i);1347093252==g.view.getUint32(0)?(w(l,g,4,!1,o),d=l.offset+30+l.filenameLength+l.extraFieldLength,r.init((function(){0===l.compressionMethod?m(l._worker,s++,t,r,d,l.compressedSize,u,p,c,f,h):function(t,n,r,i,o,a,s,c,u,l,p){var f=s?"output":"none";e.zip.useWebWorkers?_(t,{sn:n,codecClass:"Inflater",crcType:f},r,i,o,a,u,c,l,p):y(new e.zip.Inflater,r,i,o,a,f,u,c,l,p)}(l._worker,s++,t,r,d,l.compressedSize,u,p,c,f,h)}),h)):o(n)}),f)};var u={getEntries:function(e){var i=this._worker;!function(e){if(t.size<22)o(n);else{i(22,(function(){i(Math.min(65558,t.size),(function(){o(n)}))}))}function i(n,i){t.readUint8Array(t.size-n,n,(function(t){for(var n=t.length-22;n>=0;n--)if(80===t[n]&&75===t[n+1]&&5===t[n+2]&&6===t[n+3])return void e(new DataView(t.buffer,n,22));i()}),(function(){o(r)}))}}((function(s){var u,l;u=s.getUint32(16,!0),l=s.getUint16(8,!0),u<0||u>=t.size?o(n):t.readUint8Array(u,t.size-u,(function(t){var r,s,u,p,f=0,h=[],d=a(t.length,t);for(r=0;r<l;r++){if((s=new c)._worker=i,1347092738!=d.view.getUint32(f))return void o(n);w(s,d,f+6,!0,o),s.commentLength=d.view.getUint16(f+32,!0),s.directory=16==(16&d.view.getUint8(f+38)),s.offset=d.view.getUint32(f+42,!0),u=v(d.array.subarray(f+46,f+46+s.filenameLength)),s.filename=2048==(2048&s.bitFlag)?b(u):g(u),s.directory||"/"!=s.filename.charAt(s.filename.length-1)||(s.directory=!0),p=v(d.array.subarray(f+46+s.filenameLength+s.extraFieldLength,f+46+s.filenameLength+s.extraFieldLength+s.commentLength)),s.comment=2048==(2048&s.bitFlag)?b(p):g(p),h.push(s),f+=46+s.filenameLength+s.extraFieldLength+s.commentLength}e(h)}),(function(){o(r)}))}))},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null),e&&e()},_worker:null};e.zip.useWebWorkers?P("inflater",(function(e){u._worker=e,i(u)}),(function(e){o(e)})):i(u)}function O(e){return unescape(encodeURIComponent(e))}function C(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function I(t,n,r,i){var o={},s=[],c=0,u=0;function l(e){r(e||"Error while writing zip file.")}function p(e){r(e||"Error while reading file data.")}var f={add:function(n,f,h,d,g){var b,v,w,S=this._worker;function I(e,n){var r=a(16);c+=e||0,r.view.setUint32(0,1347094280),void 0!==n&&(b.view.setUint32(10,n,!0),r.view.setUint32(4,n,!0)),f&&(r.view.setUint32(8,e,!0),b.view.setUint32(14,e,!0),r.view.setUint32(12,f.size,!0),b.view.setUint32(18,f.size,!0)),t.writeUint8Array(r.array,(function(){c+=16,h()}),l)}function E(){g=g||{},n=n.trim(),g.directory&&"/"!=n.charAt(n.length-1)&&(n+="/"),o.hasOwnProperty(n)?r("File already exists."):(v=C(O(n)),s.push(n),function(e){var r;w=g.lastModDate||new Date,b=a(26),o[n]={headerArray:b.array,directory:g.directory,filename:v,offset:c,comment:C(O(g.comment||""))},b.view.setUint32(0,335546376),g.version&&b.view.setUint8(0,g.version),i||0===g.level||g.directory||b.view.setUint16(4,2048),b.view.setUint16(6,(w.getHours()<<6|w.getMinutes())<<5|w.getSeconds()/2,!0),b.view.setUint16(8,(w.getFullYear()-1980<<4|w.getMonth()+1)<<5|w.getDate(),!0),b.view.setUint16(22,v.length,!0),(r=a(30+v.length)).view.setUint32(0,1347093252),r.array.set(b.array,4),r.array.set(v,30),c+=r.array.length,t.writeUint8Array(r.array,e,l)}((function(){f?i||0===g.level?m(S,u++,f,t,0,f.size,!0,I,d,p,l):function(t,n,r,i,o,a,s,c,u){e.zip.useWebWorkers?_(t,{sn:n,options:{level:o},codecClass:"Deflater",crcType:"input"},r,i,0,r.size,s,a,c,u):y(new e.zip.Deflater,r,i,0,r.size,"input",s,a,c,u)}(S,u++,f,t,g.level,I,d,p,l):I()})))}f?f.init(E,p):E()},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null);var n,r,i,u=0,p=0;for(r=0;r<s.length;r++)u+=46+(i=o[s[r]]).filename.length+i.comment.length;for(n=a(u+22),r=0;r<s.length;r++)i=o[s[r]],n.view.setUint32(p,1347092738),n.view.setUint16(p+4,5120),n.array.set(i.headerArray,p+6),n.view.setUint16(p+32,i.comment.length,!0),i.directory&&n.view.setUint8(p+38,16),n.view.setUint32(p+42,i.offset,!0),n.array.set(i.filename,p+46),n.array.set(i.comment,p+46+i.filename.length),p+=46+i.filename.length+i.comment.length;n.view.setUint32(p,1347093766),n.view.setUint16(p+8,s.length,!0),n.view.setUint16(p+10,s.length,!0),n.view.setUint32(p+12,u,!0),n.view.setUint32(p+16,c,!0),t.writeUint8Array(n.array,(function(){t.getData(e)}),l)},_worker:null};e.zip.useWebWorkers?P("deflater",(function(e){f._worker=e,n(f)}),(function(e){r(e)})):n(f)}i.prototype.append=function(e){for(var t=0|this.crc,n=this.table,r=0,i=0|e.length;r<i;r++)t=t>>>8^n[255&(t^e[r])];this.crc=t},i.prototype.get=function(){return~this.crc},i.prototype.table=function(){var e,t,n,r=[];for(e=0;e<256;e++){for(n=e,t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;r[e]=n}return r}(),o.prototype.append=function(e,t){return e},o.prototype.flush=function(){},c.prototype=new s,c.prototype.constructor=c,u.prototype=new s,u.prototype.constructor=u,l.prototype=new s,l.prototype.constructor=l,p.prototype.getData=function(e){e(this.data)},f.prototype=new p,f.prototype.constructor=f,h.prototype=new p,h.prototype.constructor=h,d.prototype=new p,d.prototype.constructor=d;var E={deflater:["z-worker.js","deflate.js"],inflater:["z-worker.js","inflate.js"]};function P(t,n,r){if(null===e.zip.workerScripts||null===e.zip.workerScriptsPath){var i,o,a;if(e.zip.workerScripts){if(i=e.zip.workerScripts[t],!Array.isArray(i))return void r(new Error("zip.workerScripts."+t+" is not an array!"));o=i,a=document.createElement("a"),i=o.map((function(e){return a.href=e,a.href}))}else(i=E[t].slice(0))[0]=(e.zip.workerScriptsPath||"")+i[0];var s=new Worker(i[0]);s.codecTime=s.crcTime=0,s.postMessage({type:"importScripts",scripts:i.slice(1)}),s.addEventListener("message",(function e(t){var i=t.data;if(i.error)return s.terminate(),void r(i.error);"importScripts"===i.type&&(s.removeEventListener("message",e),s.removeEventListener("error",c),n(s))})),s.addEventListener("error",c)}else r(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));function c(e){s.terminate(),r(e)}}function A(e){console.error(e)}e.zip={Reader:s,Writer:p,BlobReader:l,Data64URIReader:u,TextReader:c,BlobWriter:d,Data64URIWriter:h,TextWriter:f,createReader:function(e,t,n){n=n||A,e.init((function(){S(e,t,n)}),n)},createWriter:function(e,t,n,r){n=n||A,r=!!r,e.init((function(){I(e,t,n,r)}),n)},useWebWorkers:!0,workerScriptsPath:null,workerScripts:null}}(void 0)},function(e,t,n){var r={"./attachment-delete-controller.js":11,"./attachment-upload-controller.js":12};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"connect",value:function(){}},{key:"delete",value:function(e){e.stopPropagation(),e.preventDefault();var t=new FormData;return t.append("_method","DELETE"),fetch(this.element.getAttribute("href"),{method:"POST",headers:{"X-CSRF-Token":document.querySelector("meta[name=csrf-token]").content},body:t}).then(this.handleErrors).then((function(e){e.json().then((function(e){var t=document.querySelector(e.selector);t&&(t.innerHTML=e.html)}))})).catch((function(e){console.log(e)})),!1}},{key:"handleErrors",value:function(e){if(!e.ok)throw new Error(e.status);return e}}]),t}(n(0).Controller);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var s=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"connect",value:function(){var e=this;e.data.has("param-name")||console.warn(this.element,"has no data-upload-param attribute, uploads may not work"),e.element.addEventListener("dragover",(function(t){e.element.classList.add("dragging"),t.preventDefault()})),e.element.addEventListener("dragleave",(function(t){e.element.classList.remove("dragging"),t.preventDefault()})),e.element.addEventListener("dragenter",(function(t){e.element.classList.add("dragging"),t.preventDefault()})),e.element.addEventListener("drop",(function(t){if(0!=t.dataTransfer.files.length){e.element.classList.remove("dragging"),t.preventDefault(),t.cancelBubble=!0;var n=new FormData;if(e.data.has("extra-data")){var i=!0,o=!1,a=void 0;try{for(var s,c=Object.entries(JSON.parse(e.data.get("extra-data")))[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value,l=r(u,2),p=l[0],f=l[1];n.append(p,f)}}catch(e){o=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}}for(var h=0;h<t.dataTransfer.files.length;h++)n.append(e.data.get("param-name"),t.dataTransfer.files[h]);e.element.classList.add("uploading"),fetch(e.data.get("url"),{method:"POST",headers:{"X-CSRF-Token":document.querySelector("meta[name=csrf-token]").content},body:n}).then(e.handleErrors).then((function(t){t.json().then((function(t){e.element.classList.remove("uploading");var n=document.querySelector(t.selector);n&&(n.innerHTML=t.html)}))})).catch((function(t){console.log(t),e.element.classList.remove("uploading")}))}}))}},{key:"handleErrors",value:function(e){if(!e.ok)throw new Error(e.status);return e}}]),t}(n(0).Controller);t.default=s},function(e,t,n){"use strict";function r(e){return e.keys().map((function(t){return function(e,t){var n=i(t);if(n)return function(e,t){var n=e.default;if("function"==typeof n)return{identifier:t,controllerConstructor:n}}(e(t),n)}(e,t)})).filter((function(e){return e}))}function i(e){var t=(e.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/)||[])[1];if(t)return t.replace(/_/g,"-").replace(/\//g,"--")}n.r(t),n.d(t,"definitionsFromContext",(function(){return r})),n.d(t,"identifierForContextKey",(function(){return i}))}])}));